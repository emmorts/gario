{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/buffercodec/index.js","node_modules/smartmap/index.js","src/client/js/Game.js","src/client/js/Graph.js","src/client/js/WSController.js","src/client/js/app.js","src/client/js/models/Player.js","src/client/js/models/index.js","src/client/js/packets/AddPlayer.js","src/client/js/packets/UpdatePlayers.js","src/client/js/packets/UpdateSpells.js","src/client/js/packets/index.js","src/client/js/spells/Primary.js","src/client/js/spells/index.js","src/client/js/statistics/Score.js","src/client/js/statistics/index.js","src/client/js/util/DomElement.js","src/client/js/util/EventEmitter.js","src/client/js/util/KeyCode.js","src/client/js/util/polyfills.js","src/opCode.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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","file":"game.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","function BufferCodec(buffer) {\r\n  if (!(this instanceof BufferCodec)) {\r\n    return new BufferCodec(buffer);\r\n  }\r\n\r\n  this.offset = 0;\r\n  this.jobs = [];\r\n\r\n  if (buffer) {\r\n    if (buffer.byteLength > 0) {\r\n      if (buffer instanceof ArrayBuffer) {\r\n        this.buffer = buffer;\r\n      } else {\r\n        var arrayBuffer = new ArrayBuffer(buffer.length);\r\n        var view = new Uint8Array(arrayBuffer);\r\n        for (var i = 0; i < buffer.length; ++i) {\r\n          view[i] = buffer[i];\r\n        }\r\n        this.buffer = arrayBuffer;\r\n      }\r\n    }\r\n    if (!this.buffer) {\r\n      console.warn(\"Received malformed data\");\r\n    }\r\n  }\r\n}\r\n\r\nBufferCodec.prototype.result = function () {\r\n  this.offset = 0;\r\n  \r\n  var bufferLength = this.jobs.reduce(function(last, current) {\r\n    return last + current.length;\r\n  }, 0);\r\n  var buffer = new ArrayBuffer(bufferLength);\r\n  var dataView = new DataView(buffer);\r\n  \r\n  if (this.jobs.length > 0) {\r\n    this.jobs.forEach(function (job) {\r\n      if (job.method !== 'string') {\r\n        dataView[job.method](this.offset, job.data, job.littleEndian);\r\n        this.offset += job.length;\r\n      } else {\r\n        if (job.encoding === 'utf16') {\r\n          for (var i = 0; i < job.length / 2; i++, this.offset += 2) {\r\n            dataView.setUint16(this.offset, job.data.charCodeAt(i), true);\r\n          }\r\n        } else if (job.encoding === 'utf8') {\r\n          for (var i = 0; i < job.length; i++, this.offset++) {\r\n            dataView.setUint8(this.offset, job.data.charCodeAt(i));\r\n          }\r\n        } else {\r\n          console.warn('Undefined encoding: ' + job.encoding);\r\n        }\r\n      }\r\n    }, this);\r\n  }\r\n  \r\n  this.jobs = [];\r\n  \r\n  return dataView.buffer;\r\n}\r\n\r\nBufferCodec.prototype.string = function (value, encoding) {\r\n  this.jobs.push({\r\n    method: 'string',\r\n    data: value,\r\n    length: (!encoding || encoding === 'utf16') ? value.length * 2 : value.length,\r\n    encoding: encoding ? encoding : 'utf16'\r\n  });\r\n\r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.int8 = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setInt8',\r\n    length: 1\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.uint8 = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setUint8',\r\n    length: 1\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.int16le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setInt16',\r\n    length: 2,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.int16be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setInt16',\r\n    length: 2,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.uint16le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setUint16',\r\n    length: 2,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.uint16be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setUint16',\r\n    length: 2,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.int32le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setInt32',\r\n    length: 4,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.int32be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setInt32',\r\n    length: 4,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.uint32le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setUint32',\r\n    length: 4,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.uint32be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setUint32',\r\n    length: 4,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.float32le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setFloat32',\r\n    length: 4,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.float32be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setFloat32',\r\n    length: 4,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.float64le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setFloat64',\r\n    length: 8,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.float64be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setFloat64',\r\n    length: 8,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.parse = function (template, transform) {\r\n  if (this.buffer && template) {\r\n    var data = new DataView(this.buffer);\r\n    var result = {}, element = {};\r\n    \r\n    if (template.constructor === Object) {\r\n      for (var propertyName in template) {\r\n        element = {\r\n          name: propertyName\r\n        };\r\n        \r\n        if (template[propertyName].constructor === Array) {\r\n          element.type = 'array'\r\n          element.itemTemplate = template[propertyName][0];\r\n        } else if (template[propertyName].constructor === String) {\r\n          element.type = template[propertyName];\r\n        } else if (template[propertyName].constructor === Object) {\r\n          for (var innerPropertyName in template[propertyName]) {\r\n            element[innerPropertyName] = template[propertyName][innerPropertyName];\r\n          }\r\n        }\r\n        \r\n        parseItem.call(this, element, result);\r\n      }\r\n    } else if (template.constructor === Array) {\r\n      element = {\r\n        type: 'array',\r\n        itemTemplate: template[0]\r\n      };\r\n      \r\n      parseItem.call(this, element, result);\r\n    }\r\n    \r\n    if (transform) {\r\n      return transform(result);\r\n    } else {\r\n      return result;\r\n    }\r\n  }\r\n\r\n  function parseArray(data, template) {\r\n    var result = [];\r\n\r\n    var length = data.getUint8(this.offset++);\r\n    if (length > 0) {\r\n      for (var i = 0; i < length; i++) {\r\n        result.push(this.parse(template));\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  function parseItem(element) {\r\n    var templateResult;\r\n    switch (element.type) {\r\n      case 'int8':\r\n        templateResult = data.getInt8(this.offset);\r\n        this.offset += 1;\r\n        break;\r\n      case 'uint8':\r\n        templateResult = data.getUint8(this.offset);\r\n        this.offset += 1;\r\n        break;\r\n      case 'int16le':\r\n        templateResult = data.getInt16(this.offset, true);\r\n        this.offset += 2;\r\n        break;\r\n      case 'uint16le':\r\n        templateResult = data.getUint16(this.offset, true);\r\n        this.offset += 2;\r\n        break;\r\n      case 'int16be':\r\n        templateResult = data.getInt16(this.offset, false);\r\n        this.offset += 2;\r\n        break;\r\n      case 'uint16be':\r\n        templateResult = data.getUint16(this.offset, false);\r\n        this.offset += 2;\r\n        break;\r\n      case 'int32le':\r\n        templateResult = data.getInt32(this.offset, true);\r\n        this.offset += 4;\r\n        break;\r\n      case 'uint32le':\r\n        templateResult = data.getUint32(this.offset, true);\r\n        this.offset += 4;\r\n        break;\r\n      case 'int32be':\r\n        templateResult = data.getInt32(this.offset, false);\r\n        this.offset += 4;\r\n        break;\r\n      case 'uint32be':\r\n        templateResult = data.getUint32(this.offset, false);\r\n        this.offset += 4;\r\n        break;\r\n      case 'float32le':\r\n        templateResult = data.getFloat32(this.offset, true);\r\n        this.offset += 4;\r\n        break;\r\n      case 'float32be':\r\n        templateResult = data.getFloat32(this.offset, false);\r\n        this.offset += 4;\r\n        break;\r\n      case 'float64le':\r\n        templateResult = data.getFloat64(this.offset, true);\r\n        this.offset += 8;\r\n        break;\r\n      case 'float64be':\r\n        templateResult = data.getFloat64(this.offset, false);\r\n        this.offset += 8;\r\n        break;\r\n      case 'string':\r\n        if (typeof element.length === 'undefined') {\r\n          element.length = data.getUint8(this.offset++);\r\n        } else if (!element.length) {\r\n          templateResult = '';\r\n          break;\r\n        }\r\n        if (!element.encoding || element.encoding === 'utf16') {\r\n          var utf16 = new ArrayBuffer(element.length * 2);\r\n          var utf16view = new Uint16Array(utf16);\r\n          for (var i = 0; i < element.length; i++ , this.offset += 2) {\r\n            utf16view[i] = data.getUint8(this.offset);\r\n          }\r\n          templateResult = String.fromCharCode.apply(null, utf16view);\r\n        } else if (element.encoding === 'utf8') {\r\n          var utf8 = new ArrayBuffer(element.length);\r\n          var utf8view = new Uint8Array(utf8);\r\n          for (var i = 0; i < element.length; i++ , this.offset += 2) {\r\n            utf8view[i] = data.getUint8(this.offset);\r\n          }\r\n          templateResult = String.fromCharCode.apply(null, utf8view);\r\n        }\r\n        break;\r\n      case 'array':\r\n        templateResult = parseArray.call(this, data, element.itemTemplate);\r\n        break;\r\n      default:\r\n        console.error('Type ' + element.type + ' is not supported.');\r\n    }\r\n\r\n    if (element.name) {\r\n      result[element.name] = templateResult;\r\n    } else {\r\n      result = templateResult;\r\n    }\r\n  }\r\n}\r\n\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = BufferCodec;\r\n} else {\r\n  window.BufferCodec = BufferCodec;\r\n}","(function (global, factory) {\r\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n  typeof define === 'function' && define.amd ? define(factory) :\r\n  (global.Immutable = factory());\r\n})(this, function () {\r\n  var SmartMap = function () {\r\n    if (arguments.length === 0) {\r\n      _warn(\"Unable to initialize SmartMap, no indices provided.\");\r\n      return;\r\n    }\r\n    this.indices = Array.prototype.slice.call(arguments);\r\n    this.length = 0;\r\n    this._head = {};\r\n    this._tail = {};\r\n    this._position = {};\r\n    this._keys = {};\r\n    this._debug = true;\r\n  }\r\n  \r\n  SmartMap.prototype.add = function (object) {\r\n    if (this.indices.length > 0) {\r\n      var node = { v: Object.seal(object) };\r\n      \r\n      this.indices.forEach(function (index) {\r\n        if (!(index in this._keys)) {\r\n          this._keys[index] = {};\r\n        }\r\n        \r\n        if (index in object) {\r\n          var key = object[index];\r\n          \r\n          if (this.length === 0) {\r\n            this._head[index] = this._tail[index] = node;\r\n            node.p = node.n = undefined;\r\n            this.reset();\r\n          } else {\r\n            node.p = this._tail[index];\r\n            node.n = undefined;\r\n            this._tail[index].n = node;\r\n            this._tail[index] = node;\r\n          }\r\n          \r\n          this._keys[index][key] = node;\r\n          \r\n        } else {\r\n          _warn(\"Index `\" + index + \"` doesn't exist in given object.\");\r\n        }\r\n      }.bind(this));\r\n      \r\n      this.length++;\r\n    }\r\n  }\r\n  \r\n  SmartMap.prototype.get = function (key, index) {\r\n    if (index in this._keys) {\r\n      if (key in this._keys[index]) {\r\n        return this._keys[index][key].v;\r\n      } else {\r\n        _warn(\"Undefined key `\" + key + \"` in index `\" + index + \"`.\");\r\n      }\r\n    } else {\r\n      _warn(\"Undefined index `\" + index + \"`.\");\r\n    }\r\n    \r\n    return undefined;\r\n  }\r\n  \r\n  SmartMap.prototype.delete = function (key, index) {\r\n    if (index in this._keys && key in this._keys[index]) {\r\n      var object;\r\n      var node = this._keys[index][key];\r\n\r\n      if (node) {\r\n        object = node.v;\r\n\r\n        if (node.p) node.p.n = node.n;\r\n        if (node.n) node.n.p = node.p;\r\n        if (node === this._tail[index]) this._tail[index] = this._tail[index].p; \r\n\r\n        this._keys[index][key] = undefined;\r\n        this.length--;\r\n        \r\n        delete this._keys[index][key];\r\n      }\r\n\r\n      return object;\r\n    }\r\n    \r\n    return undefined;\r\n  }\r\n  \r\n  SmartMap.prototype.reset = function () {\r\n    this._position = this.indices.reduce(function (pos, index) {\r\n      if (index in this._head) {\r\n        pos[index] = { n: this._head[index] };\r\n      } else {\r\n        pos[index] = { n : undefined };\r\n      }\r\n      return pos;\r\n    }.bind(this), {});\r\n  }\r\n  \r\n  SmartMap.prototype.empty = function () {\r\n    this._keys = {};\r\n    this._head = this._tail = {};\r\n    this.length = 0;\r\n    this.reset();\r\n  };\r\n  \r\n  SmartMap.prototype.forEach = function (fn, thisArg) {\r\n    var tmp, index = 0;\r\n    \r\n    if (this.length) {\r\n      var iterateBy = this.indices[0];\r\n      while (tmp = _next.call(this, iterateBy)) {\r\n        if (thisArg) {\r\n          fn.call(thisArg, tmp.v, index);\r\n        } else {\r\n          fn(tmp.v, index);\r\n        }\r\n        index++;\r\n      }\r\n      \r\n      this.reset();\r\n    }\r\n  }\r\n  \r\n  SmartMap.prototype.find = function (predicate, thisArg) {\r\n    var tmp, result;\r\n    \r\n    if (this.length) {\r\n      var iterateBy = this.indices[0];\r\n      while (tmp = _next.call(this, iterateBy)) {\r\n        var passes = thisArg ? predicate.call(this, tmp.v) : predicate(tmp.v);\r\n        if (passes) {\r\n          result = tmp.v;\r\n          this.reset();\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    \r\n    return result;\r\n  }\r\n  \r\n  return SmartMap;\r\n  \r\n  function _validateObject(object) {\r\n    var validatedProperties = 0;\r\n    for (var property in object) {\r\n      if (~this.indices.indexOf(property)) validatedProperties++;\r\n    }\r\n    return validatedProperties === this.indices.length;\r\n  }\r\n  \r\n  function _next(index) {\r\n    return this._position[index] = this._position[index].n;\r\n  }\r\n  \r\n  function _warn(message) {\r\n    if (this._debug) {\r\n      console.warn(message);\r\n    }\r\n  }\r\n});","import SmartMap from 'smartmap';\nimport WSController from './WSController';\nimport EventEmitter from './util/EventEmitter';\nimport * as Spells from './spells';\nimport * as Models from './models';\n\nlet instance = null;\n\nexport default class Game extends EventEmitter {\n  constructor() {\n    super();\n    \n    this.started = false;\n    this.currentPlayer = null;\n    this.controller = null;\n    this.playerList = new SmartMap('id', 'ownerId');\n    this.spellList = new SmartMap('id');\n  }\n\n  static getInstance() {\n    if (instance) {\n      return instance;\n    } else {\n      instance = new Game();\n      return instance;\n    }\n  }\n  \n  startGame(playerName, onConnection) {\n    this.controller = new WSController();\n    \n    this.controller.on('open', function startGame() {\n      \n      this.controller.on('addPlayer', this._handleAddPlayer.bind(this));\n      this.controller.on('updatePlayers', this._handleUpdatePlayers.bind(this));\n      this.controller.on('updateSpells', this._handleUpdateSpells.bind(this));\n      \n      this.controller.spawn(playerName);\n      \n      this.onStart(onConnection);\n    }.bind(this));\n  }\n  \n  update(deltaT) {    \n    this.playerList.forEach(player => player.calculateNextPosition(deltaT));\n    this.spellList.forEach(spell => spell.calculateNextPosition(deltaT));\n    \n    this.spellList.forEach((spell, spellIndex) => {\n      this.playerList.forEach(player => {\n        if (spell.ownerId !== player.ownerId) {\n          const distanceX = player.position.x - spell.position.x;\n          const distanceY = player.position.y - spell.position.y;\n          const distance = distanceX * distanceX + distanceY * distanceY;\n          if (distance < Math.pow(spell.radius + player.radius, 2)) {\n            spell.onCollision(player);\n            this.spellList.delete(spell.id, 'id');\n          }\n        }\n      });\n    });\n  }\n  \n  onStart(callback) {\n    this.started = true;\n    \n    if (callback) {\n      callback();\n    }\n  }\n  \n  _handleAddPlayer (player) {\n    this.currentPlayer = new Models.Player(player);\n    this._fire('addPlayer');\n    this.playerList.add(this.currentPlayer);\n  }\n  \n  _handleUpdatePlayers (players) {\n    const updatedPlayers = players.updatedPlayers;\n    if (updatedPlayers && updatedPlayers.length > 0) {\n      updatedPlayers.forEach(updatedPlayer => {\n        const foundPlayer = this.playerList.get(updatedPlayer.id, 'id');\n        if (foundPlayer) {\n          foundPlayer.setTarget(updatedPlayer.target);\n        } else {\n          const player = new Models.Player(updatedPlayer);\n          this.playerList.add(player);\n        }\n      }, this);\n    }\n    \n    const destroyedPlayers = players.destroyedPlayers;\n    if (destroyedPlayers && destroyedPlayers.length > 0) {\n      destroyedPlayers.forEach(destroyedPlayer => this.playerList.delete(destroyedPlayer, 'id'), this);\n    }\n  }\n  \n  _handleUpdateSpells (spells) {\n    const updatedSpells = spells.updatedSpells;\n    if (updatedSpells && updatedSpells.length > 0) {\n      updatedSpells.forEach(updatedSpell => {\n        const SpellClass = Spells.get(updatedSpell.type);\n        const spell = new SpellClass(updatedSpell);\n        spell.onAdd(this.playerList.get(spell.ownerId, 'ownerId'));\n        this.spellList.add(spell);\n      }, this);\n    }\n    \n    const destroyedSpells = spells.destroyedSpells;\n    if (destroyedSpells && destroyedSpells.length > 0) {\n      destroyedSpells.forEach(destroyedSpell => this.spellList.delete(destroyedSpell, 'id'), this);\n    }\n  }\n}","var OPCode = require('../../opCode');\r\n\r\nimport * as Statistics from './statistics';\r\n\r\nexport default class Graph {\r\n  constructor(canvas) {\r\n    this._canvas = canvas;\r\n    this._context = this._canvas.getContext('2d');\r\n\r\n    this.screenWidth = this._canvas.width = getDefaultWidth();\r\n    this.screenHeight = this._canvas.height = getDefaultHeight();\r\n    this.xOffset = 0;\r\n    this.yOffset = 0;\r\n    this._borderColor = '#666';\r\n    this._gridColor = '#ececec';\r\n    this._globalAlpha = 0.15;\r\n    this._gameWidth = 1000;\r\n    this._gameHeight = 1000;\r\n    this._arenaSize = 500;\r\n    this.__scrollSpeed = 4;\r\n  \r\n    window.addEventListener('resize', onResize.bind(this));\r\n\r\n    this.player = {\r\n      id: -1,\r\n      position: {\r\n        x: this.screenWidth / 2,\r\n        y: this.screenHeight / 2\r\n      }\r\n    };\r\n\r\n    this._playerOptions = {\r\n      border: 6,\r\n      borderColor: '#CCCCCC',\r\n      textColor: '#FFFFFF',\r\n      textBorder: '#000000',\r\n      textBorderSize: 3,\r\n      fontSize: 12,\r\n      defaultSize: 30\r\n    };\r\n  }\r\n  \r\n  clear() {\r\n    this._context.fillStyle = 'rgb(255, 255, 255)';\r\n    this._context.fillRect(0, 0, this.screenWidth, this.screenHeight);\r\n\r\n    return this;\r\n  }\r\n  \r\n  updateOffset(scroll) {\r\n    switch (scroll) {\r\n      case OPCode.DIRECTION_NWEST:\r\n        this.xOffset -= this.__scrollSpeed;\r\n        this.yOffset -= this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_NEAST:\r\n        this.xOffset += this.__scrollSpeed;\r\n        this.yOffset -= this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_SWEST:\r\n        this.xOffset -= this.__scrollSpeed;\r\n        this.yOffset += this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_SEAST:\r\n        this.xOffset += this.__scrollSpeed;\r\n        this.yOffset += this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_WEST:\r\n        this.xOffset -= this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_EAST:\r\n        this.xOffset += this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_NORTH:\r\n        this.yOffset -= this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_SOUTH:\r\n        this.yOffset += this.__scrollSpeed;\r\n        break;\r\n    }\r\n    \r\n    this.xOffset = Math.max(this.xOffset, 0);\r\n    this.xOffset = Math.min(this.xOffset, (this._gameWidth - this._arenaSize) / 2);\r\n    this.yOffset = Math.max(this.yOffset, 0);\r\n    this.yOffset = Math.min(this.yOffset, (this._gameHeight - this._arenaSize) / 2);\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawDebug() {\r\n    if (this.player.id !== -1) {\r\n      // COORDINATES\r\n      var posX = this.player.position.x;\r\n      var posY = this.player.position.y;\r\n      var coordinates = 'Coordinates: ' + Math.round(posX) + ' ' + Math.round(posY);\r\n      this.drawText(coordinates, 50, 50);\r\n      \r\n      // OFFSET\r\n      var offset = 'Offset: ' + Math.round(this.xOffset) + ' ' + Math.round(this.yOffset);\r\n      this.drawText(offset, 50, 70);\r\n      \r\n      // VELOCITY\r\n      var velocity = 'Velocity: ' + Math.round(this.player.velocity.x) + ' ' + Math.round(this.player.velocity.y);\r\n      this.drawText(velocity, 50, 30);\r\n\r\n      // Score\r\n      var score = 'Score: ' + Statistics.Score.getInstance().currentScore();\r\n      this.drawText(score, 50, 10);\r\n    }\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawArena() {\r\n    this._context.lineWidth = 2;\r\n    this._context.beginPath();\r\n    \r\n    var startX = (this._gameWidth - this._arenaSize) / 2 - this.xOffset;\r\n    var startY = (this._gameHeight - this._arenaSize) / 2 - this.yOffset;\r\n    \r\n    this._context.moveTo(startX, startY);\r\n    this._context.lineTo(startX, startY + this._arenaSize);\r\n    this._context.lineTo(startX + this._arenaSize, startY + this._arenaSize);\r\n    this._context.lineTo(startX + this._arenaSize, startY);\r\n    this._context.lineTo(startX, startY);\r\n    \r\n    this._context.strokeStyle = '#000';\r\n    this._context.stroke();\r\n    this._context.fillStyle = '#eee';\r\n    this._context.fill();\r\n    \r\n    this._context.closePath();\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawGrid() {\r\n    this._context.lineWidth = 1;\r\n    this._context.strokeStyle = this._gridColor;\r\n    this._context.beginPath();\r\n\r\n    for (var x = -this.xOffset; x < this.screenWidth + this.xOffset; x += 40) {\r\n      x = Math.round(x) + 0.5;\r\n      this._context.moveTo(x, 0);\r\n      this._context.lineTo(x, this.screenHeight);\r\n    }\r\n\r\n    for (var y = -this.yOffset; y < this.screenHeight + this.yOffset; y += 40) {\r\n      x = Math.round(y) + 0.5;\r\n      this._context.moveTo(0, y);\r\n      this._context.lineTo(this.screenWidth, y);\r\n    }\r\n\r\n    this._context.stroke();\r\n\r\n    return this;\r\n  }\r\n  \r\n  drawText(text, x, y, fontSize, hasStroke = true) {\r\n    if (typeof fontSize === 'undefined') {\r\n      fontSize = this._playerOptions.fontSize;\r\n    }\r\n    this._context.lineWidth = this._playerOptions.textBorderSize;\r\n    this._context.fillStyle = this._playerOptions.textColor;\r\n    this._context.strokeStyle = this._playerOptions.textBorder;\r\n    this._context.font = 'bold ' + fontSize + 'px sans-serif';\r\n    this._context.miterLimit = 1;\r\n    this._context.lineJoin = 'round';\r\n    this._context.textBaseline = 'middle';\r\n    if (hasStroke) {\r\n      this._context.strokeText(text, x, y);\r\n    }\r\n    this._context.fillText(text, x, y);\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawPlayer(player) {\r\n    var posX = player.position.x - this.xOffset;\r\n    var posY = player.position.y - this.yOffset;\r\n    \r\n    var arcLength = 2 * (player.health / player.maxHealth) * Math.PI;\r\n    var deficit = (2 * Math.PI - arcLength) / 2;\r\n    var arcStart = player.rotation + deficit;\r\n    var arcEnd = arcLength + player.rotation + deficit;\r\n\r\n    this._context.beginPath();\r\n    this._context.arc(posX, posY, player.radius, 0, 2 * Math.PI);\r\n    this._context.fillStyle = getColorInRGB(player.color);\r\n    this._context.fill();\r\n    this._context.closePath();\r\n    \r\n    this._context.beginPath();\r\n    this._context.arc(posX, posY, player.radius - 3, arcStart, arcEnd);\r\n    this._context.lineWidth = 6;\r\n    this._context.strokeStyle = getHealthColor(player.health, player.maxHealth);\r\n    this._context.stroke();\r\n    this._context.closePath();\r\n\r\n    this._context.textAlign = 'center';\r\n    this.drawText(player.name, posX, posY - 40, 14);\r\n    this._context.textAlign = 'left';\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawPlayers(playerList) {\r\n    var currentPlayer = playerList.get(this.player.id, 'id');\r\n    if (currentPlayer) {\r\n      this.player.position.x = currentPlayer.position.x;\r\n      this.player.position.y = currentPlayer.position.y;\r\n    }\r\n    playerList.forEach(player => this.drawPlayer(player));\r\n\r\n    return this;\r\n  }\r\n  \r\n  drawSpell(spell) {\r\n    var posX = spell.position.x - this.xOffset;\r\n    var posY = spell.position.y - this.yOffset;\r\n    \r\n    this._context.beginPath();\r\n    this._context.arc(posX, posY, spell.radius, 0, 2 * Math.PI);\r\n    this._context.fillStyle = getColorInRGB(spell.color);\r\n    this._context.fill();\r\n    this._context.closePath();\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawSpells(spellList = []) {\r\n    spellList.forEach(spell => this.drawSpell(spell));\r\n    \r\n    return this;\r\n  }\r\n  \r\n};\r\n\r\nfunction getColorInRGB(color, lightenPct) {\r\n  if (color) {\r\n    var r = color.r,\r\n      g = color.g,\r\n      b = color.b;\r\n    if (lightenPct) {\r\n      r = Math.round(r - r * lightenPct);\r\n      g = Math.round(g - g * lightenPct);\r\n      b = Math.round(b - b * lightenPct);\r\n    }\r\n    return 'rgb(' + r + ', ' + g + ', ' + b + ')';\r\n  }\r\n  return 'rgb(0, 0, 0)';\r\n}\r\n\r\nfunction getHealthColor(health, maxHealth) {\r\n  var hue = Math.floor((health / maxHealth) * 120);\r\n  \r\n  return 'hsl(' + hue + ', 100%, 50%)';\r\n}\r\n\r\nfunction onResize() {\r\n  this.screenWidth = this._canvas.width = getDefaultWidth();\r\n  this.screenHeight = this._canvas.height = getDefaultHeight();\r\n}\r\n\r\nfunction isValueInRange(min, max, value) {\r\n  return Math.min(max, Math.max(min, value));\r\n}\r\n\r\nfunction getDefaultWidth() {\r\n  return window.innerWidth && document.documentElement.clientWidth\r\n    ? Math.min(window.innerWidth, document.documentElement.clientWidth)\r\n    : window.innerWidth ||\r\n    document.documentElement.clientWidth ||\r\n    document.getElementsByTagName('body')[0].clientWidth;\r\n}\r\n\r\nfunction getDefaultHeight() {\r\n  return window.innerHeight && document.documentElement.clientHeight\r\n    ? Math.min(window.innerHeight, document.documentElement.clientHeight)\r\n    : window.innerHeight ||\r\n    document.documentElement.clientHeight ||\r\n    document.getElementsByTagName('body')[0].clientHeight;\r\n}","var BufferCodec = require('buffercodec');\r\nvar OPCode = require('../../opCode');\r\n\r\nimport EventEmitter from './util/EventEmitter';\r\nimport * as Packets from './packets/index';\r\n\r\nexport default class WSController extends EventEmitter {\r\n  constructor() {\r\n    super();\r\n    \r\n    this._uri = 'ws://192.168.1.142:3000';\r\n    this._socket = null;\r\n\r\n    this._setupSocket();\r\n  }\r\n  \r\n  spawn(playerName) {\r\n    var buffer = BufferCodec()\r\n      .uint8(OPCode.SPAWN_PLAYER)\r\n      .uint8(playerName.length)\r\n      .string(playerName)\r\n      .result();\r\n      \r\n    this._socket.send(buffer);\r\n  }\r\n  \r\n  move(player) {\r\n    var buffer = BufferCodec()\r\n      .uint8(OPCode.PLAYER_MOVE)\r\n      .uint16le(player.target.x)\r\n      .uint16le(player.target.y)\r\n      .result();\r\n\r\n    this._socket.send(buffer);\r\n  }\r\n  \r\n  cast(opcode, options) {\r\n    var buffer = BufferCodec()\r\n      .uint8(opcode)\r\n      .uint16le(options.playerX)\r\n      .uint16le(options.playerY)\r\n      .uint16le(options.x)\r\n      .uint16le(options.y)\r\n      .result();\r\n\r\n    this._socket.send(buffer);\r\n  }\r\n  \r\n  _setupSocket() {\r\n    this._socket = new WebSocket(this._uri);\r\n    this._socket.binaryType = 'arraybuffer';\r\n\r\n    this._socket.onopen = function onConnectionEstablished(event) {\r\n      this._fire('open');\r\n\r\n      this._socket.onmessage = function handleMessage(message) {\r\n        var codec = BufferCodec(message.data);\r\n        var code = this._getOpCode(codec);\r\n\r\n        switch (code) {\r\n          case OPCode.ADD_PLAYER:\r\n            this._fire('addPlayer', this._parse(codec, Packets.AddPlayer));\r\n            break;\r\n          case OPCode.UPDATE_PLAYERS:\r\n            this._fire('updatePlayers', this._parse(codec, Packets.UpdatePlayers));\r\n            break;\r\n          case OPCode.UPDATE_SPELLS:\r\n            this._fire('updateSpells', this._parse(codec, Packets.UpdateSpells));\r\n            break;\r\n          default:\r\n            console.warn(\"Undefined opcode\");\r\n            break;\r\n        }\r\n      }.bind(this)\r\n    }.bind(this)\r\n  }\r\n  \r\n  _parse(codec, packet) {\r\n    return codec.parse(packet.mapping, packet.transform);\r\n  }\r\n  \r\n  _getOpCode(codec) {\r\n    return codec.parse({ code: 'uint8' }, obj => obj.code);\r\n  }\r\n}","require('./util/polyfills');\r\n\r\nconst OPCode = require('../../opCode');\r\n\r\nimport KeyCode from './util/KeyCode';\r\nimport DomElement from './util/DomElement';\r\nimport Graph from './Graph';\r\nimport Game from './Game';\r\nimport * as Statistics from './statistics';\r\n\r\nvar animationLoopHandle;\r\nvar lastUpdate;\r\nvar targetTick = performance.now();\r\nvar mouse = { x: 0, y: 0 };\r\nvar scrollDirection = null;\r\nvar game = Game.getInstance();\r\n\r\nvar canvas = new DomElement('.js-canvas', Graph);\r\nvar graph = canvas.instance;\r\n\r\nvar playerNameElement = new DomElement('.js-player-name');\r\nvar playButtonElement = new DomElement('.js-play-button');\r\nvar errorElement = new DomElement('.js-error');\r\n\r\nif (playButtonElement.htmlElement) {\r\n  playButtonElement.on('mouseup', startGame);\r\n}\r\n\r\nif (playerNameElement.htmlElement) {\r\n  playerNameElement.on('keyup', validate);\r\n}\r\n\r\nfunction validate(event) {\r\n  if (~[KeyCode.ENTER, KeyCode.MAC_ENTER].indexOf(event.keyCode)) {\r\n    startGame();\r\n  } else {\r\n    var pattern = /^[a-zA-Z0-9 ]{0,25}$/;\r\n    if (event.target.value.match(pattern)) {\r\n      errorElement.htmlElement.style.display = 'none';\r\n      playButtonElement.htmlElement.disabled = false;\r\n    } else {\r\n      errorElement.htmlElement.style.display = 'block';\r\n      playButtonElement.htmlElement.disabled = true;\r\n    }\r\n  }\r\n}\r\n\r\nfunction animationLoop(timestamp) {\r\n  animationLoopHandle = window.requestAnimationFrame(animationLoop);\r\n  \r\n  gameLoop(timestamp - lastUpdate);\r\n  lastUpdate = timestamp;\r\n}\r\n\r\nfunction gameLoop(deltaT) {\r\n  graph\r\n    .clear()\r\n    .updateOffset(scrollDirection)\r\n    .drawGrid()\r\n    .drawArena()\r\n    .drawSpells(game.spellList)\r\n    .drawPlayers(game.playerList)\r\n    .drawDebug();\r\n    \r\n  game.update();\r\n}\r\n\r\nfunction startGame () {\r\n  new DomElement('.js-start-menu').htmlElement.style.display = 'none';\r\n  \r\n  game.startGame(playerNameElement.htmlElement.value, () => {\r\n    window.document.addEventListener('keydown', wHandleKeyDown);\r\n    \r\n    canvas.on('contextmenu', event => event.preventDefault());\r\n    canvas.on('mousemove', cHandleMouseMove);\r\n    canvas.on('mousedown', cHandleMouseDown);\r\n  });\r\n  \r\n  game.on('addPlayer', () => graph.player = game.currentPlayer);\r\n  \r\n  if (!animationLoopHandle) {\r\n    lastUpdate = Date.now();\r\n    animationLoop(lastUpdate);\r\n  }\r\n  \r\n  function cHandleMouseMove(event) {\r\n    var westBreakpoint = graph.screenWidth / 10,\r\n        eastBreakpoint = graph.screenWidth * 9 / 10,\r\n        northBreakpoint = graph.screenHeight / 10,\r\n        southBreakpoint = graph.screenHeight * 9 / 10;\r\n        \r\n    if (event.x < westBreakpoint && event.y < northBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_NWEST;\r\n    } else if (event.x > eastBreakpoint && event.y < northBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_NEAST;\r\n    } else if (event.x < westBreakpoint && event.y > southBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_SWEST;\r\n    } else if (event.x > eastBreakpoint && event.y > southBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_SEAST;\r\n    } else if (event.x < westBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_WEST;\r\n    } else if (event.x > eastBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_EAST;\r\n    } else if (event.y < northBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_NORTH;\r\n    } else if (event.y > southBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_SOUTH;\r\n    } else {\r\n      scrollDirection = null;\r\n    }\r\n    mouse.x = event.x;\r\n    mouse.y = event.y;\r\n  }\r\n  \r\n  function cHandleMouseDown(event) {\r\n    if (game.currentPlayer && event.button === KeyCode.MOUSE2) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      var now = performance.now();\r\n      var diff = now - targetTick;\r\n      if (diff > 100) {\r\n        var targetX = mouse.x + graph.xOffset;\r\n        var targetY = mouse.y + graph.yOffset;\r\n        targetX = Math.min(Math.max(targetX, 0), graph._gameWidth);\r\n        targetY = Math.min(Math.max(targetY, 0), graph._gameHeight);\r\n        game.currentPlayer.setTarget({ x: targetX, y: targetY});\r\n        targetTick = now;\r\n        game.controller.move(game.currentPlayer);\r\n      }\r\n    }\r\n  }\r\n  \r\n  function wHandleKeyDown(event) {\r\n    switch (event.keyCode) {\r\n      case KeyCode.Q:\r\n        game.controller.cast(OPCode.CAST_PRIMARY, {\r\n          playerX: game.currentPlayer.position.x,\r\n          playerY: game.currentPlayer.position.y,\r\n          x: mouse.x + graph.xOffset,\r\n          y: mouse.y + graph.yOffset\r\n        });\r\n        //For testing purposes only\r\n        const scoreHolder = Statistics.Score.getInstance();\r\n        scoreHolder.add();\r\n        break;\r\n    }\r\n  }\r\n}","export default class Player {\r\n  constructor(playerModel) {\r\n    playerModel = playerModel || {};\r\n    \r\n    this.id = playerModel.id || -1;\r\n    this.ownerId = playerModel.ownerId || -1;\r\n    this.name = playerModel.name;\r\n    this.health = playerModel.health;\r\n    this.maxHealth = playerModel.maxHealth;\r\n    this.speed = 3;\r\n    this.acceleration = 0.1;\r\n    this.rotation = 0;\r\n    this.targetRotation = 0;\r\n    this.radius = 20;\r\n    this.mass = 20;\r\n    this.velocity = { x: 0, y: 0 };\r\n    this.stunned = 0;\r\n    this._baseFriction = 0.2;\r\n    this._baseRotationTicks = 10;\r\n    this._baseCastTicks = 10;\r\n    this._baseRadius = this.radius;\r\n    this._maxRadius = 25;\r\n    this._rotationTicks = this._baseRotationTicks;\r\n    this._castTicks = this._baseCastTicks;\r\n    this._friction = this._baseFriction;\r\n    this._animateCast = false;\r\n    \r\n    this.color = {\r\n      r: playerModel.color.r || 0,\r\n      g: playerModel.color.g | 0,\r\n      b: playerModel.color.b || 0\r\n    };\r\n    \r\n    this.position = {\r\n      x: playerModel.position.x || 0,\r\n      y: playerModel.position.y || 0\r\n    };\r\n    \r\n    this.target = {\r\n      x: (playerModel.target ? playerModel.target.x : null) || playerModel.position.x || 0,\r\n      y: (playerModel.target ? playerModel.target.y : null) || playerModel.position.y || 0\r\n    };\r\n  }\r\n  \r\n  calculateNextPosition(deltaT) {\r\n    if (typeof this.target.x !== 'undefined' && typeof this.target.y !== 'undefined') {\r\n      this._calculatePosition(deltaT);\r\n    }\r\n    if (typeof this.targetRotation !== 'undefined') {\r\n      this._calculateRotation(deltaT);\r\n    }\r\n    if (this._animateCast) {\r\n      this._updateAnimation();\r\n    }\r\n  }\r\n  \r\n  setTarget(target) {\r\n    this.target = {\r\n      x: target.x,\r\n      y: target.y\r\n    };\r\n    \r\n    this.targetRotation = Math.atan2(target.y - this.position.y, target.x - this.position.x);\r\n    var diff = Math.abs(this.targetRotation - this.rotation);\r\n    \r\n    if (diff > Math.PI / 2) {\r\n      this._friction = this._baseFriction;\r\n    }\r\n  }\r\n  \r\n  onCast(spell) {\r\n    this._animateCast = true;\r\n    this.targetRotation = Math.atan2(spell.target.y - this.position.y, spell.target.x - this.position.x);\r\n  }\r\n  \r\n  _calculatePosition(deltaT) {\r\n    if (!this._arePositionsApproximatelyEqual(this.position, this.target) || this.stunned) {\r\n      if (this._friction < 1) {\r\n        this._friction += this.acceleration;\r\n      }\r\n      \r\n      var speed = this.speed * this._friction;\r\n      var velX = this.velocity.x;\r\n      var velY = this.velocity.y;\r\n      var velocity = 0, fn;\r\n      \r\n      if (!this.stunned) {\r\n        var vX = this.target.x - this.position.x;\r\n        var vY = this.target.y - this.position.y;\r\n        var distance = this._getHypotenuseLength(vX, vY);\r\n        \r\n        velX = (vX / distance) * speed;\r\n        velY = (vY / distance) * speed;\r\n      }\r\n      \r\n      if (Math.abs(this.velocity.x - velX) > this.acceleration) {\r\n        velocity = this.acceleration * Math.sign(velX);\r\n        fn = Math.sign(velX) !== 1 ? Math.max : Math.min;\r\n        this.velocity.x = fn(this.velocity.x + velocity, Math.sign(velX) * speed); \r\n      } else {\r\n        this.velocity.x = velX;\r\n      }\r\n      \r\n      if (Math.abs(this.velocity.y - velY) > this.acceleration) {\r\n        velocity = this.acceleration * Math.sign(velY);\r\n        fn = Math.sign(velY) !== 1 ? Math.max : Math.min;\r\n        this.velocity.y = fn(this.velocity.y + velocity, Math.sign(velY) * speed); \r\n      } else {\r\n        this.velocity.y = velY;\r\n      }\r\n      \r\n      this.position.x += this.velocity.x;\r\n      this.position.y += this.velocity.y;\r\n      \r\n      if (this.stunned) {\r\n        this.velocity.x *= (1 - this.acceleration);\r\n        this.velocity.y *= (1 - this.acceleration);\r\n        this.target.x = this.position.x;\r\n        this.target.y = this.position.y;\r\n        this.stunned--;\r\n      }\r\n    } else {\r\n      this._friction = this._baseFriction;\r\n      this.velocity = { x: 0, y: 0 };\r\n    }\r\n  }\r\n  \r\n  _calculateRotation(deltaT) {\r\n    if (Math.abs(this.rotation - this.targetRotation) > 1e-5) {\r\n      if (this._rotationTicks > 0) {\r\n        if (this.rotation > Math.PI) {\r\n          this.rotation = -Math.PI - (Math.PI - Math.abs(this.rotation));\r\n        } else if (this.rotation < -Math.PI) {\r\n          this.rotation = Math.PI + (Math.PI - Math.abs(this.rotation));\r\n        }\r\n        if (Math.abs(this.targetRotation - this.rotation) > Math.PI) {\r\n          var diffA = Math.PI - Math.abs(this.rotation);\r\n          var diffB = Math.PI - Math.abs(this.targetRotation);\r\n          var diff = diffA + diffB;\r\n          if (this.rotation > 0) {\r\n            this.rotation += diff / this._rotationTicks;\r\n          } else {\r\n            this.rotation -= diff / this._rotationTicks;\r\n          }\r\n        } else {\r\n          this.rotation += (this.targetRotation - this.rotation) / this._rotationTicks;\r\n        }\r\n      } else {\r\n        this.rotation = this.targetRotation;\r\n        this._rotationTicks = this._baseRotationTicks;\r\n      }\r\n    }\r\n  }\r\n  \r\n  _updateAnimation() {\r\n    if (this._castTicks > 0) {\r\n      var sign = Math.sign(this._castTicks - this._baseCastTicks / 2);\r\n      this.radius += sign * (this._maxRadius - this.radius) / 4;\r\n      this._castTicks--;\r\n    } else {\r\n      this.radius = this._baseRadius;\r\n      this._castTicks = this._baseCastTicks;\r\n      this._animateCast = false;\r\n      this.targetRotation = Math.atan2(this.target.y - this.position.y, this.target.x - this.position.x);\r\n    }\r\n  }\r\n  \r\n  _getHypotenuseLength(x, y) {\r\n    return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\r\n  }\r\n  \r\n  _arePositionsApproximatelyEqual(positionA, positionB) {\r\n    var errorMargin = 5;\r\n    return (Math.abs(positionA.x - positionB.x) < errorMargin) && (Math.abs(positionA.y - positionB.y) < errorMargin);\r\n  }\r\n}","export { default as Player } from './Player';","export default {\n  mapping: {\n    id: { type: 'string', length: 32 },\n    ownerId: { type: 'string', length: 32},\n    name: 'string',\n    health: 'uint16le',\n    maxHealth: 'uint16le',\n    x: 'float32le',\n    y: 'float32le',\n    r: 'uint8',\n    g: 'uint8',\n    b: 'uint8'\n  },\n  transform: (player) => {\n    return {\n      id: player.id,\n      ownerId: player.ownerId,\n      name: player.name,\n      health: player.health,\n      maxHealth: player.maxHealth,\n      position: { x: player.x, y: player.y },\n      color: { r: player.r, g: player.g, b: player.b }\n    };\n  }\n};","export default {\n  mapping: {\n    updatedPlayers: [{\n      id: { type: 'string', length: 32 },\n      ownerId: { type: 'string', length: 32},\n      name: 'string',\n      health: 'uint16le',\n      maxHealth: 'uint16le',\n      x: 'float32le',\n      y: 'float32le',\n      targetX: 'float32le',\n      targetY: 'float32le',\n      r: 'uint8',\n      g: 'uint8',\n      b: 'uint8'\n    }],\n    destroyedPlayers: [{\n      id: { type: 'string', length: 32 }\n    }]\n  },\n  transform: (object) => {\n    const updatedPlayers = object.updatedPlayers.map(player => {\n      return {\n        id: player.id,\n        ownerId: player.ownerId,\n        name: player.name,\n        health: player.health,\n        maxHealth: player.maxHealth,\n        position: { x: player.x, y: player.y },\n        target: { x: player.targetX, y: player.targetY },\n        color: { r: player.r, g: player.g, b: player.b }\n      };\n    });\n    const destroyedPlayers = object.destroyedPlayers.map(player => player.id);\n    \n    return {\n      updatedPlayers,\n      destroyedPlayers\n    };\n  }\n};","export default {\n  mapping: {\n    updatedSpells: [{\n      id: { type: 'string', length: 32 },\n      ownerId: { type: 'string', length: 32 },\n      type: 'uint8',\n      mass: 'uint8',\n      power: 'uint8',\n      x: 'float32le',\n      y: 'float32le',\n      targetX: 'float32le',\n      targetY: 'float32le',\n      r: 'uint8',\n      g: 'uint8',\n      b: 'uint8'\n    }],\n    destroyedSpells: [{\n      id: { type: 'string', length: 32 }\n    }]\n  },\n  transform: (object) => {\n    const updatedSpells = object.updatedSpells.map(spell => {\n      return {\n        id: spell.id,\n        ownerId: spell.ownerId,\n        type: spell.type,\n        mass: spell.mass,\n        power: spell.power,\n        position: { x: spell.x, y: spell.y },\n        target: { x: spell.targetX, y: spell.targetY },\n        color: { r: spell.r, g: spell.g, b: spell.b }\n      };\n    });\n    const destroyedSpells = object.destroyedSpells.map(spell => spell.id);\n    \n    return {\n      updatedSpells,\n      destroyedSpells\n    };\n  }\n}","export { default as AddPlayer } from './AddPlayer';\nexport { default as UpdatePlayers } from './UpdatePlayers';\nexport { default as UpdateSpells } from './UpdateSpells';","export default class Primary {\n  constructor(spellModel) {\n    this.id = spellModel.id;\n    this.ownerId = spellModel.ownerId;\n    this.type = spellModel.type;\n    this.mass = spellModel.mass;\n    this.power = spellModel.power;\n    this.velocity = { x: 0, y: 0 };\n    this.speed = 5;\n    this.radius = 10;\n    \n    this.color = spellModel.color || { r: 0, g: 0, b: 0 };\n    this.position = spellModel.position || { x: 0, y: 0 };\n    \n    this.setTarget(spellModel.target);\n  }\n  \n  calculateNextPosition() {\n    if (typeof this.velocity.x !== 'undefined' && typeof this.velocity.y !== 'undefined') {\n      this._calculatePosition.call(this);\n    }\n  }\n  \n  onAdd(owner) {\n    owner.onCast(this);\n  }\n  \n  onCollision(model) {\n    model.health -= this.power;\n    \n    model.velocity.x += this.power * this.mass * this.velocity.x / model.mass;\n    model.velocity.y += this.power * this.mass * this.velocity.y / model.mass;\n    \n    model.stunned = 50;\n  }\n  \n  setTarget(target) {\n    this.target = {\n      x: target.x,\n      y: target.y\n    };\n    \n    var vX = this.target.x - this.position.x;\n    var vY = this.target.y - this.position.y;\n    var distance = this._getHypotenuseLength(vX, vY);\n    \n    this.velocity = {\n      x: vX / distance,\n      y: vY / distance\n    };\n  }\n  \n  _calculatePosition() {\n    this.position = {\n      x: this.position.x + this.velocity.x * this.speed,\n      y: this.position.y + this.velocity.y * this.speed\n    };\n  }\n  \n  _getHypotenuseLength(x, y) {\n    return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n  }\n}","var OPCode = require('../../../opCode');\n\nexport { default as Primary } from './Primary';\n\nexport function get(code) {\n  var spell = null;\n  \n  switch (code) {\n    case OPCode.SPELL_PRIMARY:\n      spell = module.exports.Primary;\n      break;\n  }\n  \n  return spell;\n}","let instance = null;\n\nexport default class Score {\n    constructor() {\n        this._score = 0;\n    }\n\n    static getInstance() {\n        if (instance) {\n            return instance;\n        } else {\n            instance = new Score();\n            return instance;\n        }\n    }\n\n    add(s = 1) {\n        this._score += s;\n    }\n\n    currentScore() {\n        return this._score;\n    }\n}","export { default as Score } from './Score';","export default class DomElement {\n  constructor(query, elementClass) {\n    this.htmlElement = null;\n    this.instance = null;\n    this._eventHandlers = [];\n    \n    if (query) {\n      this.htmlElement = window.document.querySelector(query);\n      \n      if (this.htmlElement && elementClass) {\n        this.instance = new elementClass(this.htmlElement);\n      }\n    }\n  }\n  \n  on(name, listener) {\n    if (!(name in this._eventHandlers) || !(this._eventHandlers[name] instanceof Array)) {\n      this._eventHandlers[name] = [];\n    }\n    if (!~this._eventHandlers[name].indexOf(listener)) {\n      this._eventHandlers[name].push(listener);\n      \n      this.htmlElement.addEventListener(name, listener);\n    }\n    \n    return this;\n  }\n}","export default class EventEmitter {\n  constructor() {\n    this._eventHandlers = {};\n  }\n  \n  on(name, listener) {\n    if (!(name in this._eventHandlers) || !(this._eventHandlers[name] instanceof Array)) {\n      this._eventHandlers[name] = [];\n    }\n    this._eventHandlers[name].push(listener);\n  }\n  \n  _fire(name, options) {\n    if (name in this._eventHandlers && this._eventHandlers[name].length > 0) {\n      this._eventHandlers[name].forEach(handler => handler(options));\n    }\n  }\n}","export default {\n  MOUSE2: 2,\n  MAC_ENTER: 3,\n  BACKSPACE: 8,\n  TAB: 9,\n  NUM_CENTER: 12,\n  ENTER: 13,\n  SHIFT: 16,\n  CTRL: 17,\n  ALT: 18,\n  PAUSE: 19,\n  CAPS_LOCK: 20,\n  ESC: 27,\n  SPACE: 32,\n  PAGE_UP: 33,\n  PAGE_DOWN: 34,\n  END: 35,\n  HOME: 36,\n  LEFT: 37,\n  UP: 38,\n  RIGHT: 39,\n  DOWN: 40,\n  PRINT_SCREEN: 44,\n  INSERT: 45,\n  DELETE: 46,\n  ZERO: 48,\n  ONE: 49,\n  TWO: 50,\n  THREE: 51,\n  FOUR: 52,\n  FIVE: 53,\n  SIX: 54,\n  SEVEN: 55,\n  EIGHT: 56,\n  NINE: 57,\n  A: 65,\n  B: 66,\n  C: 67,\n  D: 68,\n  E: 69,\n  F: 70,\n  G: 71,\n  H: 72,\n  I: 73,\n  J: 74,\n  K: 75,\n  L: 76,\n  M: 77,\n  N: 78,\n  O: 79,\n  P: 80,\n  Q: 81,\n  R: 82,\n  S: 83,\n  T: 84,\n  U: 85,\n  V: 86,\n  W: 87,\n  X: 88,\n  Y: 89,\n  Z: 90,\n  META: 91,\n  CONTEXT_MENU: 93,\n  NUM_ZERO: 96,\n  NUM_ONE: 97,\n  NUM_TWO: 98,\n  NUM_THREE: 99,\n  NUM_FOUR: 100,\n  NUM_FIVE: 101,\n  NUM_SIX: 102,\n  NUM_SEVEN: 103,\n  NUM_EIGHT: 104,\n  NUM_NINE: 105,\n  NUM_MULTIPLY: 106,\n  NUM_PLUS: 107,\n  NUM_MINUS: 109,\n  NUM_PERIOD: 110,\n  NUM_DIVISION: 111,\n  F1: 112,\n  F2: 113,\n  F3: 114,\n  F4: 115,\n  F5: 116,\n  F6: 117,\n  F7: 118,\n  F8: 119,\n  F9: 120,\n  F10: 121,\n  F11: 122,\n  F12: 123\n};","if (!Array.prototype.find) {\n  Array.prototype.find = function (predicate) {\n    if (this === null) {\n      throw new TypeError('Array.prototype.find called on null or undefined');\n    }\n    if (typeof predicate !== 'function') {\n      throw new TypeError('predicate must be a function');\n    }\n    var list = Object(this);\n    var length = list.length >>> 0;\n    var thisArg = arguments[1];\n    var value;\n\n    for (var i = 0; i < length; i++) {\n      value = list[i];\n      if (predicate.call(thisArg, value, i, list)) {\n        return value;\n      }\n    }\n    return undefined;\n  };\n}\n\nif (!Date.now) {\n  Date.now = function () {\n    return new Date().getTime();\n  };\n}\n\n(function () {\n  'use strict';\n\n  var vendors = ['webkit', 'moz'];\n  for (var i = 0; i < vendors.length && !window.requestAnimationFrame; ++i) {\n    var vp = vendors[i];\n    window.requestAnimationFrame = window[vp + 'RequestAnimationFrame'];\n    window.cancelAnimationFrame = (window[vp + 'CancelAnimationFrame']\n      || window[vp + 'CancelRequestAnimationFrame']);\n  }\n  if (/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent) // iOS6 is buggy\n    || !window.requestAnimationFrame || !window.cancelAnimationFrame) {\n    var lastTime = 0;\n    window.requestAnimationFrame = function (callback) {\n      var now = Date.now();\n      var nextTime = Math.max(lastTime + 16, now);\n      return setTimeout(function () { callback(lastTime = nextTime); },\n        nextTime - now);\n    };\n    window.cancelAnimationFrame = clearTimeout;\n  }\n} ());","const operations = [\n  \"PING\",\n  \"PONG\",\n  \"SPAWN_PLAYER\",\n  \"ADD_PLAYER\",\n  \"UPDATE_PLAYERS\",\n  \"UPDATE_SPELLS\",\n  \"PLAYER_MOVE\",\n  \n  // cast\n  \"CAST_PRIMARY\",\n  \n  // spells\n  \"SPELL_PRIMARY\",\n\n  // models\n  \"MODEL_PLAYER\",\n  \n  // direction\n  \"DIRECTION_WEST\",\n  \"DIRECTION_EAST\",\n  \"DIRECTION_NORTH\",\n  \"DIRECTION_SOUTH\",\n  \"DIRECTION_NWEST\",\n  \"DIRECTION_NEAST\",\n  \"DIRECTION_SWEST\",\n  \"DIRECTION_SEAST\",\n\n  // types\n  \"TYPE_SPELL\",\n  \"TYPE_MODEL\",\n  \"TYPE_GAMEMODE\",\n  \"TYPE_MAP\"\n];\n\nconst opCodes = {};\n\noperations.forEach((op, index) => opCodes[op] = ++index);\n\nmodule.exports = opCodes;"]}