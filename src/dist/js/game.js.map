{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","node_modules/buffercodec/index.js","node_modules/smartmap/index.js","src/client/js/Game.js","src/client/js/Graph.js","src/client/js/WSController.js","src/client/js/app.js","src/client/js/models/Player.js","src/client/js/models/index.js","src/client/js/packets/AddPlayer.js","src/client/js/packets/UpdatePlayers.js","src/client/js/packets/UpdateSpells.js","src/client/js/packets/index.js","src/client/js/spells/Primary.js","src/client/js/spells/index.js","src/client/js/util/DomElement.js","src/client/js/util/EventEmitter.js","src/client/js/util/KeyCode.js","src/client/js/util/polyfills.js","src/opCode.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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","file":"game.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","function BufferCodec(buffer) {\r\n  if (!(this instanceof BufferCodec)) {\r\n    return new BufferCodec(buffer);\r\n  }\r\n\r\n  this.offset = 0;\r\n  this.jobs = [];\r\n\r\n  if (buffer) {\r\n    if (buffer.byteLength > 0) {\r\n      if (buffer instanceof ArrayBuffer) {\r\n        this.buffer = buffer;\r\n      } else {\r\n        var arrayBuffer = new ArrayBuffer(buffer.length);\r\n        var view = new Uint8Array(arrayBuffer);\r\n        for (var i = 0; i < buffer.length; ++i) {\r\n          view[i] = buffer[i];\r\n        }\r\n        this.buffer = arrayBuffer;\r\n      }\r\n    }\r\n    if (!this.buffer) {\r\n      console.warn(\"Received malformed data\");\r\n    }\r\n  }\r\n}\r\n\r\nBufferCodec.prototype.result = function () {\r\n  this.offset = 0;\r\n  \r\n  var bufferLength = this.jobs.reduce(function(last, current) {\r\n    return last + current.length;\r\n  }, 0);\r\n  var buffer = new ArrayBuffer(bufferLength);\r\n  var dataView = new DataView(buffer);\r\n  \r\n  if (this.jobs.length > 0) {\r\n    this.jobs.forEach(function (job) {\r\n      if (job.method !== 'string') {\r\n        dataView[job.method](this.offset, job.data, job.littleEndian);\r\n        this.offset += job.length;\r\n      } else {\r\n        if (job.encoding === 'utf16') {\r\n          for (var i = 0; i < job.length / 2; i++, this.offset += 2) {\r\n            dataView.setUint16(this.offset, job.data.charCodeAt(i), true);\r\n          }\r\n        } else if (job.encoding === 'utf8') {\r\n          for (var i = 0; i < job.length; i++, this.offset++) {\r\n            dataView.setUint8(this.offset, job.data.charCodeAt(i));\r\n          }\r\n        } else {\r\n          console.warn('Undefined encoding: ' + job.encoding);\r\n        }\r\n      }\r\n    }, this);\r\n  }\r\n  \r\n  this.jobs = [];\r\n  \r\n  return dataView.buffer;\r\n}\r\n\r\nBufferCodec.prototype.string = function (value, encoding) {\r\n  this.jobs.push({\r\n    method: 'string',\r\n    data: value,\r\n    length: (!encoding || encoding === 'utf16') ? value.length * 2 : value.length,\r\n    encoding: encoding ? encoding : 'utf16'\r\n  });\r\n\r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.int8 = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setInt8',\r\n    length: 1\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.uint8 = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setUint8',\r\n    length: 1\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.int16le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setInt16',\r\n    length: 2,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.int16be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setInt16',\r\n    length: 2,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.uint16le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setUint16',\r\n    length: 2,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.uint16be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setUint16',\r\n    length: 2,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.int32le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setInt32',\r\n    length: 4,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.int32be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setInt32',\r\n    length: 4,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.uint32le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setUint32',\r\n    length: 4,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.uint32be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setUint32',\r\n    length: 4,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.float32le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setFloat32',\r\n    length: 4,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.float32be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setFloat32',\r\n    length: 4,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.float64le = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setFloat64',\r\n    length: 8,\r\n    littleEndian: true\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.float64be = function (value) {\r\n  this.jobs.push({\r\n    data: value,\r\n    method: 'setFloat64',\r\n    length: 8,\r\n    littleEndian: false\r\n  });\r\n  \r\n  return this;\r\n}\r\n\r\nBufferCodec.prototype.parse = function (template, transform) {\r\n  if (this.buffer && template) {\r\n    var data = new DataView(this.buffer);\r\n    var result = {}, element = {};\r\n    \r\n    if (template.constructor === Object) {\r\n      for (var propertyName in template) {\r\n        element = {\r\n          name: propertyName\r\n        };\r\n        \r\n        if (template[propertyName].constructor === Array) {\r\n          element.type = 'array'\r\n          element.itemTemplate = template[propertyName][0];\r\n        } else if (template[propertyName].constructor === String) {\r\n          element.type = template[propertyName];\r\n        } else if (template[propertyName].constructor === Object) {\r\n          for (var innerPropertyName in template[propertyName]) {\r\n            element[innerPropertyName] = template[propertyName][innerPropertyName];\r\n          }\r\n        }\r\n        \r\n        parseItem.call(this, element, result);\r\n      }\r\n    } else if (template.constructor === Array) {\r\n      element = {\r\n        type: 'array',\r\n        itemTemplate: template[0]\r\n      };\r\n      \r\n      parseItem.call(this, element, result);\r\n    }\r\n    \r\n    if (transform) {\r\n      return transform(result);\r\n    } else {\r\n      return result;\r\n    }\r\n  }\r\n\r\n  function parseArray(data, template) {\r\n    var result = [];\r\n\r\n    var length = data.getUint8(this.offset++);\r\n    if (length > 0) {\r\n      for (var i = 0; i < length; i++) {\r\n        result.push(this.parse(template));\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  function parseItem(element) {\r\n    var templateResult;\r\n    switch (element.type) {\r\n      case 'int8':\r\n        templateResult = data.getInt8(this.offset);\r\n        this.offset += 1;\r\n        break;\r\n      case 'uint8':\r\n        templateResult = data.getUint8(this.offset);\r\n        this.offset += 1;\r\n        break;\r\n      case 'int16le':\r\n        templateResult = data.getInt16(this.offset, true);\r\n        this.offset += 2;\r\n        break;\r\n      case 'uint16le':\r\n        templateResult = data.getUint16(this.offset, true);\r\n        this.offset += 2;\r\n        break;\r\n      case 'int16be':\r\n        templateResult = data.getInt16(this.offset, false);\r\n        this.offset += 2;\r\n        break;\r\n      case 'uint16be':\r\n        templateResult = data.getUint16(this.offset, false);\r\n        this.offset += 2;\r\n        break;\r\n      case 'int32le':\r\n        templateResult = data.getInt32(this.offset, true);\r\n        this.offset += 4;\r\n        break;\r\n      case 'uint32le':\r\n        templateResult = data.getUint32(this.offset, true);\r\n        this.offset += 4;\r\n        break;\r\n      case 'int32be':\r\n        templateResult = data.getInt32(this.offset, false);\r\n        this.offset += 4;\r\n        break;\r\n      case 'uint32be':\r\n        templateResult = data.getUint32(this.offset, false);\r\n        this.offset += 4;\r\n        break;\r\n      case 'float32le':\r\n        templateResult = data.getFloat32(this.offset, true);\r\n        this.offset += 4;\r\n        break;\r\n      case 'float32be':\r\n        templateResult = data.getFloat32(this.offset, false);\r\n        this.offset += 4;\r\n        break;\r\n      case 'float64le':\r\n        templateResult = data.getFloat64(this.offset, true);\r\n        this.offset += 8;\r\n        break;\r\n      case 'float64be':\r\n        templateResult = data.getFloat64(this.offset, false);\r\n        this.offset += 8;\r\n        break;\r\n      case 'string':\r\n        if (typeof element.length === 'undefined') {\r\n          element.length = data.getUint8(this.offset++);\r\n        } else if (!element.length) {\r\n          templateResult = '';\r\n          break;\r\n        }\r\n        if (!element.encoding || element.encoding === 'utf16') {\r\n          var utf16 = new ArrayBuffer(element.length * 2);\r\n          var utf16view = new Uint16Array(utf16);\r\n          for (var i = 0; i < element.length; i++ , this.offset += 2) {\r\n            utf16view[i] = data.getUint8(this.offset);\r\n          }\r\n          templateResult = String.fromCharCode.apply(null, utf16view);\r\n        } else if (element.encoding === 'utf8') {\r\n          var utf8 = new ArrayBuffer(element.length);\r\n          var utf8view = new Uint8Array(utf8);\r\n          for (var i = 0; i < element.length; i++ , this.offset += 2) {\r\n            utf8view[i] = data.getUint8(this.offset);\r\n          }\r\n          templateResult = String.fromCharCode.apply(null, utf8view);\r\n        }\r\n        break;\r\n      case 'array':\r\n        templateResult = parseArray.call(this, data, element.itemTemplate);\r\n        break;\r\n      default:\r\n        console.error('Type ' + element.type + ' is not supported.');\r\n    }\r\n\r\n    if (element.name) {\r\n      result[element.name] = templateResult;\r\n    } else {\r\n      result = templateResult;\r\n    }\r\n  }\r\n}\r\n\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = BufferCodec;\r\n} else {\r\n  window.BufferCodec = BufferCodec;\r\n}","(function (global, factory) {\r\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n  typeof define === 'function' && define.amd ? define(factory) :\r\n  (global.Immutable = factory());\r\n})(this, function () {\r\n  var SmartMap = function () {\r\n    if (arguments.length === 0) {\r\n      _warn(\"Unable to initialize SmartMap, no indices provided.\");\r\n      return;\r\n    }\r\n    this.indices = Array.prototype.slice.call(arguments);\r\n    this.length = 0;\r\n    this._head = null;\r\n    this._tail = null;\r\n    this._position = null;\r\n    this._keys = {};\r\n    this._debug = true;\r\n  }\r\n  \r\n  SmartMap.prototype.add = function (object) {\r\n    if (this.indices.length > 0) {\r\n      var node = { v: Object.seal(object) };\r\n      \r\n      this.indices.forEach(function (index) {\r\n        if (!(index in this._keys)) {\r\n          this._keys[index] = {};\r\n        }\r\n        \r\n        if (index in object) {\r\n          var key = object[index];\r\n          \r\n          if (this.length === 0) {\r\n            this._head = this._tail = node;\r\n            this.reset();\r\n          } else {\r\n            node.p = this._tail;\r\n            this._tail.n = node;\r\n            this._tail = node;\r\n          }\r\n          \r\n          this._keys[index][key] = node;\r\n          \r\n        } else {\r\n          _warn(\"Index `\" + index + \"` doesn't exist in given object.\");\r\n        }\r\n      }.bind(this));\r\n      \r\n      this.length++;\r\n    }\r\n  }\r\n  \r\n  SmartMap.prototype.get = function (key, index) {\r\n    if (index in this._keys) {\r\n      if (key in this._keys[index]) {\r\n        return this._keys[index][key].v;\r\n      } else {\r\n        _warn(\"Undefined key `\" + key + \"` in index `\" + index + \"`.\");\r\n      }\r\n    } else {\r\n      _warn(\"Undefined index `\" + index + \"`.\");\r\n    }\r\n    \r\n    return undefined;\r\n  }\r\n  \r\n  SmartMap.prototype.delete = function (key, index) {\r\n    if (index in this._keys && key in this._keys[index]) {\r\n      var object;\r\n      var node = this._keys[index][key];\r\n\r\n      if (node) {\r\n        object = node.v;\r\n\r\n        if (node.p) node.p.n = node.n;\r\n        if (node.n) node.n.p = node.p;\r\n\r\n        this._keys[index][key] = null;\r\n        this.length--;\r\n      }\r\n\r\n      return object;\r\n    }\r\n    \r\n    return undefined;\r\n  }\r\n  \r\n  SmartMap.prototype.reset = function () {\r\n    this._position = { n: this._head };\r\n  }\r\n  \r\n  SmartMap.prototype.empty = function () {\r\n    this._keys = {};\r\n    this._head = this._tail = this._position = null;\r\n    this.length = 0;\r\n  };\r\n  \r\n  SmartMap.prototype.forEach = function (fn, thisArg) {\r\n    var tmp, index = 0;\r\n    \r\n    if (this.length) {\r\n      while (tmp = _next.call(this)) {\r\n        if (thisArg) {\r\n          fn.call(thisArg, tmp.v, index);\r\n        } else {\r\n          fn(tmp.v, index);\r\n        }\r\n        index++;\r\n      }\r\n      \r\n      this.reset();\r\n    }\r\n  }\r\n  \r\n  SmartMap.prototype.find = function (predicate, thisArg) {\r\n    var tmp, result;\r\n    \r\n    if (this.length) {\r\n      while (tmp = _next.call(this)) {\r\n        var passes = thisArg ? predicate.call(this, tmp.v) : predicate(tmp.v);\r\n        if (passes) {\r\n          result = tmp.v;\r\n          this.reset();\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    \r\n    return result;\r\n  }\r\n  \r\n  return SmartMap;\r\n  \r\n  function _validateObject(object) {\r\n    var validatedProperties = 0;\r\n    for (var property in object) {\r\n      if (~this.indices.indexOf(property)) validatedProperties++;\r\n    }\r\n    return validatedProperties === this.indices.length;\r\n  }\r\n  \r\n  function _next() {\r\n    return this._position = this._position.n;\r\n  }\r\n  \r\n  function _warn(message) {\r\n    if (this._debug) {\r\n      console.warn(message);\r\n    }\r\n  }\r\n});","import SmartMap from 'smartmap';\r\nimport WSController from './WSController';\r\nimport EventEmitter from './util/EventEmitter';\r\nimport * as Spells from './spells';\r\nimport * as Models from './models';\r\n\r\nexport default class Game extends EventEmitter {\r\n  constructor() {\r\n    super();\r\n    \r\n    this.started = false;\r\n    this.currentPlayer = null;\r\n    this.controller = null;\r\n    this.playerList = new SmartMap('id', 'ownerId');\r\n    this.spellList = new SmartMap('id');\r\n  }\r\n  \r\n  startGame(playerName, onConnection) {\r\n    this.controller = new WSController();\r\n    \r\n    this.controller.on('open', function startGame() {\r\n      \r\n      this.controller.on('addPlayer', this._handleAddPlayer.bind(this));\r\n      this.controller.on('updatePlayers', this._handleUpdatePlayers.bind(this));\r\n      this.controller.on('updateSpells', this._handleUpdateSpells.bind(this));\r\n      \r\n      this.controller.spawn(playerName);\r\n      \r\n      this.onStart(onConnection);\r\n    }.bind(this));\r\n  }\r\n  \r\n  update(deltaT) {    \r\n    this.playerList.forEach(player => player.calculateNextPosition(deltaT));\r\n    this.spellList.forEach(spell => spell.calculateNextPosition(deltaT));\r\n    \r\n    this.spellList.forEach((spell, spellIndex) => {\r\n      this.playerList.forEach(player => {\r\n        if (spell.ownerId !== player.ownerId) {\r\n          var distanceX = player.position.x - spell.position.x;\r\n          var distanceY = player.position.y - spell.position.y;\r\n          var distance = distanceX * distanceX + distanceY * distanceY;\r\n          if (distance < Math.pow(spell.radius + player.radius, 2)) {\r\n            spell.onCollision(player);\r\n            this.spellList.splice(spellIndex, 1);\r\n          }\r\n        }\r\n      });\r\n    });\r\n  }\r\n  \r\n  onStart(callback) {\r\n    this.started = true;\r\n    \r\n    if (callback) {\r\n      callback();\r\n    }\r\n  }\r\n  \r\n  _handleAddPlayer (player) {\r\n    this.currentPlayer = new Models.Player(player);\r\n    this._fire('addPlayer');\r\n    this.playerList.add(this.currentPlayer);\r\n  }\r\n  \r\n  _handleUpdatePlayers (players) {\r\n    var updatedPlayers = players.updatedPlayers;\r\n    if (updatedPlayers && updatedPlayers.length > 0) {\r\n      updatedPlayers.forEach(updatedPlayer => {\r\n        var foundPlayer = this.playerList.get(updatedPlayer.id, 'id');\r\n        if (foundPlayer) {\r\n          foundPlayer.setTarget(updatedPlayer.target);\r\n        } else {\r\n          var player = new Models.Player(updatedPlayer);\r\n          this.playerList.add(player);\r\n        }\r\n      });\r\n    }\r\n    \r\n    var destroyedPlayers = players.destroyedPlayers;\r\n    if (destroyedPlayers && destroyedPlayers.length > 0) {\r\n      destroyedPlayers.forEach(destroyedPlayer => this.playerList.delete(destroyedPlayer));\r\n    }\r\n  }\r\n  \r\n  _handleUpdateSpells (spells) {\r\n    var updatedSpells = spells.updatedSpells;\r\n    if (updatedSpells && updatedSpells.length > 0) {\r\n      updatedSpells.forEach(updatedSpell => {\r\n        var SpellClass = Spells.get(updatedSpell.type);\r\n        var spell = new SpellClass(updatedSpell);\r\n        spell.onAdd(this.playerList.get(spell.ownerId, 'ownerId'));\r\n        this.spellList.add(spell);\r\n      });\r\n    }\r\n    \r\n    var destroyedSpells = spells.destroyedSpells;\r\n    if (destroyedSpells && destroyedSpells.length > 0) {\r\n      destroyedSpells.forEach(destroyedSpell => this.spellList.delete(destroyedSpell));\r\n    }\r\n  }\r\n}","var OPCode = require('../../opCode');\r\n\r\nexport default class Graph {\r\n  constructor(canvas) {\r\n    this._canvas = canvas;\r\n    this._context = this._canvas.getContext('2d');\r\n\r\n    this.screenWidth = this._canvas.width = getDefaultWidth();\r\n    this.screenHeight = this._canvas.height = getDefaultHeight();\r\n    this.xOffset = 0;\r\n    this.yOffset = 0;\r\n    this._borderColor = '#666';\r\n    this._gridColor = '#ececec';\r\n    this._globalAlpha = 0.15;\r\n    this._gameWidth = 1000;\r\n    this._gameHeight = 1000;\r\n    this._arenaSize = 500;\r\n    this.__scrollSpeed = 4;\r\n  \r\n    window.addEventListener('resize', onResize.bind(this));\r\n\r\n    this.player = {\r\n      id: -1,\r\n      position: {\r\n        x: this.screenWidth / 2,\r\n        y: this.screenHeight / 2\r\n      }\r\n    };\r\n\r\n    this._playerOptions = {\r\n      border: 6,\r\n      borderColor: '#CCCCCC',\r\n      textColor: '#FFFFFF',\r\n      textBorder: '#000000',\r\n      textBorderSize: 3,\r\n      fontSize: 12,\r\n      defaultSize: 30\r\n    };\r\n  }\r\n  \r\n  clear() {\r\n    this._context.fillStyle = 'rgb(255, 255, 255)';\r\n    this._context.fillRect(0, 0, this.screenWidth, this.screenHeight);\r\n\r\n    return this;\r\n  }\r\n  \r\n  updateOffset(scroll) {\r\n    switch (scroll) {\r\n      case OPCode.DIRECTION_NWEST:\r\n        this.xOffset -= this.__scrollSpeed;\r\n        this.yOffset -= this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_NEAST:\r\n        this.xOffset += this.__scrollSpeed;\r\n        this.yOffset -= this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_SWEST:\r\n        this.xOffset -= this.__scrollSpeed;\r\n        this.yOffset += this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_SEAST:\r\n        this.xOffset += this.__scrollSpeed;\r\n        this.yOffset += this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_WEST:\r\n        this.xOffset -= this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_EAST:\r\n        this.xOffset += this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_NORTH:\r\n        this.yOffset -= this.__scrollSpeed;\r\n        break;\r\n      case OPCode.DIRECTION_SOUTH:\r\n        this.yOffset += this.__scrollSpeed;\r\n        break;\r\n    }\r\n    \r\n    this.xOffset = Math.max(this.xOffset, 0);\r\n    this.xOffset = Math.min(this.xOffset, (this._gameWidth - this._arenaSize) / 2);\r\n    this.yOffset = Math.max(this.yOffset, 0);\r\n    this.yOffset = Math.min(this.yOffset, (this._gameHeight - this._arenaSize) / 2);\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawDebug() {\r\n    if (this.player.id !== -1) {\r\n      // COORDINATES\r\n      var posX = this.player.position.x;\r\n      var posY = this.player.position.y;\r\n      var coordinates = 'Coordinates: ' + Math.round(posX) + ' ' + Math.round(posY);\r\n      this.drawText(coordinates, 50, 50);\r\n      \r\n      // OFFSET\r\n      var offset = 'Offset: ' + Math.round(this.xOffset) + ' ' + Math.round(this.yOffset);\r\n      this.drawText(offset, 50, 70);\r\n      \r\n      // VELOCITY\r\n      var velocity = 'Velocity: ' + Math.round(this.player.velocity.x) + ' ' + Math.round(this.player.velocity.y);\r\n      this.drawText(velocity, 50, 30);\r\n    }\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawArena() {\r\n    this._context.lineWidth = 2;\r\n    this._context.beginPath();\r\n    \r\n    var startX = (this._gameWidth - this._arenaSize) / 2 - this.xOffset;\r\n    var startY = (this._gameHeight - this._arenaSize) / 2 - this.yOffset;\r\n    \r\n    this._context.moveTo(startX, startY);\r\n    this._context.lineTo(startX, startY + this._arenaSize);\r\n    this._context.lineTo(startX + this._arenaSize, startY + this._arenaSize);\r\n    this._context.lineTo(startX + this._arenaSize, startY);\r\n    this._context.lineTo(startX, startY);\r\n    \r\n    this._context.strokeStyle = '#000';\r\n    this._context.stroke();\r\n    this._context.fillStyle = '#eee';\r\n    this._context.fill();\r\n    \r\n    this._context.closePath();\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawGrid() {\r\n    this._context.lineWidth = 1;\r\n    this._context.strokeStyle = this._gridColor;\r\n    this._context.beginPath();\r\n\r\n    for (var x = -this.xOffset; x < this.screenWidth + this.xOffset; x += 40) {\r\n      x = Math.round(x) + 0.5;\r\n      this._context.moveTo(x, 0);\r\n      this._context.lineTo(x, this.screenHeight);\r\n    }\r\n\r\n    for (var y = -this.yOffset; y < this.screenHeight + this.yOffset; y += 40) {\r\n      x = Math.round(y) + 0.5;\r\n      this._context.moveTo(0, y);\r\n      this._context.lineTo(this.screenWidth, y);\r\n    }\r\n\r\n    this._context.stroke();\r\n\r\n    return this;\r\n  }\r\n  \r\n  drawText(text, x, y, fontSize, hasStroke = true) {\r\n    if (typeof fontSize === 'undefined') {\r\n      fontSize = this._playerOptions.fontSize;\r\n    }\r\n    this._context.lineWidth = this._playerOptions.textBorderSize;\r\n    this._context.fillStyle = this._playerOptions.textColor;\r\n    this._context.strokeStyle = this._playerOptions.textBorder;\r\n    this._context.font = 'bold ' + fontSize + 'px sans-serif';\r\n    this._context.miterLimit = 1;\r\n    this._context.lineJoin = 'round';\r\n    this._context.textBaseline = 'middle';\r\n    if (hasStroke) {\r\n      this._context.strokeText(text, x, y);\r\n    }\r\n    this._context.fillText(text, x, y);\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawPlayer(player) {\r\n    var posX = player.position.x - this.xOffset;\r\n    var posY = player.position.y - this.yOffset;\r\n    \r\n    var arcLength = 2 * (player.health / player.maxHealth) * Math.PI;\r\n    var deficit = (2 * Math.PI - arcLength) / 2;\r\n    var arcStart = player.rotation + deficit;\r\n    var arcEnd = arcLength + player.rotation + deficit;\r\n\r\n    this._context.beginPath();\r\n    this._context.arc(posX, posY, player.radius, 0, 2 * Math.PI);\r\n    this._context.fillStyle = getColorInRGB(player.color);\r\n    this._context.fill();\r\n    this._context.closePath();\r\n    \r\n    this._context.beginPath();\r\n    this._context.arc(posX, posY, player.radius - 3, arcStart, arcEnd);\r\n    this._context.lineWidth = 6;\r\n    this._context.strokeStyle = getHealthColor(player.health, player.maxHealth);\r\n    this._context.stroke();\r\n    this._context.closePath();\r\n\r\n    this._context.textAlign = 'center';\r\n    this.drawText(player.name, posX, posY - 40, 14);\r\n    this._context.textAlign = 'left';\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawPlayers(playerList) {\r\n    var currentPlayer = playerList.get(this.player.id, 'id');\r\n    if (currentPlayer) {\r\n      this.player.position.x = currentPlayer.position.x;\r\n      this.player.position.y = currentPlayer.position.y;\r\n    }\r\n    playerList.forEach(player => this.drawPlayer(player));\r\n\r\n    return this;\r\n  }\r\n  \r\n  drawSpell(spell) {\r\n    var posX = spell.position.x - this.xOffset;\r\n    var posY = spell.position.y - this.yOffset;\r\n    \r\n    this._context.beginPath();\r\n    this._context.arc(posX, posY, spell.radius, 0, 2 * Math.PI);\r\n    this._context.fillStyle = getColorInRGB(spell.color);\r\n    this._context.fill();\r\n    this._context.closePath();\r\n    \r\n    return this;\r\n  }\r\n  \r\n  drawSpells(spellList = []) {\r\n    spellList.forEach(spell => this.drawSpell(spell));\r\n    \r\n    return this;\r\n  }\r\n  \r\n};\r\n\r\nfunction getColorInRGB(color, lightenPct) {\r\n  if (color) {\r\n    var r = color.r,\r\n      g = color.g,\r\n      b = color.b;\r\n    if (lightenPct) {\r\n      r = Math.round(r - r * lightenPct);\r\n      g = Math.round(g - g * lightenPct);\r\n      b = Math.round(b - b * lightenPct);\r\n    }\r\n    return 'rgb(' + r + ', ' + g + ', ' + b + ')';\r\n  }\r\n  return 'rgb(0, 0, 0)';\r\n}\r\n\r\nfunction getHealthColor(health, maxHealth) {\r\n  var hue = Math.floor((health / maxHealth) * 120);\r\n  \r\n  return 'hsl(' + hue + ', 100%, 50%)';\r\n}\r\n\r\nfunction onResize() {\r\n  this.screenWidth = this._canvas.width = getDefaultWidth();\r\n  this.screenHeight = this._canvas.height = getDefaultHeight();\r\n}\r\n\r\nfunction isValueInRange(min, max, value) {\r\n  return Math.min(max, Math.max(min, value));\r\n}\r\n\r\nfunction getDefaultWidth() {\r\n  return window.innerWidth && document.documentElement.clientWidth\r\n    ? Math.min(window.innerWidth, document.documentElement.clientWidth)\r\n    : window.innerWidth ||\r\n    document.documentElement.clientWidth ||\r\n    document.getElementsByTagName('body')[0].clientWidth;\r\n}\r\n\r\nfunction getDefaultHeight() {\r\n  return window.innerHeight && document.documentElement.clientHeight\r\n    ? Math.min(window.innerHeight, document.documentElement.clientHeight)\r\n    : window.innerHeight ||\r\n    document.documentElement.clientHeight ||\r\n    document.getElementsByTagName('body')[0].clientHeight;\r\n}","var BufferCodec = require('buffercodec');\r\nvar OPCode = require('../../opCode');\r\n\r\nimport EventEmitter from './util/EventEmitter';\r\nimport * as Packets from './packets/index';\r\n\r\nexport default class WSController extends EventEmitter {\r\n  constructor() {\r\n    super();\r\n    \r\n    this._uri = 'ws://127.0.0.1:3000';\r\n    this._socket = null;\r\n\r\n    this._setupSocket();\r\n  }\r\n  \r\n  spawn(playerName) {\r\n    var buffer = BufferCodec()\r\n      .uint8(OPCode.SPAWN_PLAYER)\r\n      .uint8(playerName.length)\r\n      .string(playerName)\r\n      .result();\r\n      \r\n    this._socket.send(buffer);\r\n  }\r\n  \r\n  move(player) {\r\n    var buffer = BufferCodec()\r\n      .uint8(OPCode.PLAYER_MOVE)\r\n      .uint16le(player.target.x)\r\n      .uint16le(player.target.y)\r\n      .result();\r\n\r\n    this._socket.send(buffer);\r\n  }\r\n  \r\n  cast(opcode, options) {\r\n    var buffer = BufferCodec()\r\n      .uint8(opcode)\r\n      .uint16le(options.playerX)\r\n      .uint16le(options.playerY)\r\n      .uint16le(options.x)\r\n      .uint16le(options.y)\r\n      .result();\r\n\r\n    this._socket.send(buffer);\r\n  }\r\n  \r\n  _setupSocket() {\r\n    this._socket = new WebSocket(this._uri);\r\n    this._socket.binaryType = 'arraybuffer';\r\n\r\n    this._socket.onopen = function onConnectionEstablished(event) {\r\n      this._fire('open');\r\n\r\n      this._socket.onmessage = function handleMessage(message) {\r\n        var codec = BufferCodec(message.data);\r\n        var code = this._getOpCode(codec);\r\n\r\n        switch (code) {\r\n          case OPCode.ADD_PLAYER:\r\n            this._fire('addPlayer', this._parse(codec, Packets.AddPlayer));\r\n            break;\r\n          case OPCode.UPDATE_PLAYERS:\r\n            this._fire('updatePlayers', this._parse(codec, Packets.UpdatePlayers));\r\n            break;\r\n          case OPCode.UPDATE_SPELLS:\r\n            this._fire('updateSpells', this._parse(codec, Packets.UpdateSpells));\r\n            break;\r\n          default:\r\n            console.warn(\"Undefined opcode\");\r\n            break;\r\n        }\r\n      }.bind(this)\r\n    }.bind(this)\r\n  }\r\n  \r\n  _parse(codec, packet) {\r\n    return codec.parse(packet.mapping, packet.transform);\r\n  }\r\n  \r\n  _getOpCode(codec) {\r\n    return codec.parse({ code: 'uint8' }, obj => obj.code);\r\n  }\r\n}","require('./util/polyfills');\r\n\r\nvar OPCode = require('../../opCode');\r\n\r\nimport KeyCode from './util/KeyCode';\r\nimport DomElement from './util/DomElement';\r\nimport Graph from './Graph';\r\nimport Game from './Game';\r\n\r\nvar animationLoopHandle;\r\nvar lastUpdate;\r\nvar targetTick = performance.now();\r\nvar mouse = { x: 0, y: 0 };\r\nvar scrollDirection = null;\r\nvar game = new Game();\r\n\r\nvar canvas = new DomElement('.js-canvas', Graph);\r\nvar graph = canvas.instance;\r\n\r\nvar playerNameElement = new DomElement('.js-player-name');\r\nvar playButtonElement = new DomElement('.js-play-button');\r\nvar errorElement = new DomElement('.js-error');\r\n\r\nif (playButtonElement.htmlElement) {\r\n  playButtonElement.on('mouseup', startGame);\r\n}\r\n\r\nif (playerNameElement.htmlElement) {\r\n  playerNameElement.on('keyup', validate);\r\n}\r\n\r\nfunction validate(event) {\r\n  if (~[KeyCode.ENTER, KeyCode.MAC_ENTER].indexOf(event.keyCode)) {\r\n    startGame();\r\n  } else {\r\n    var pattern = /^[a-zA-Z0-9 ]{0,25}$/;\r\n    if (event.target.value.match(pattern)) {\r\n      errorElement.htmlElement.style.display = 'none';\r\n      playButtonElement.htmlElement.disabled = false;\r\n    } else {\r\n      errorElement.htmlElement.style.display = 'block';\r\n      playButtonElement.htmlElement.disabled = true;\r\n    }\r\n  }\r\n}\r\n\r\nfunction animationLoop(timestamp) {\r\n  animationLoopHandle = window.requestAnimationFrame(animationLoop);\r\n  \r\n  gameLoop(timestamp - lastUpdate);\r\n  lastUpdate = timestamp;\r\n}\r\n\r\nfunction gameLoop(deltaT) {\r\n  graph\r\n    .clear()\r\n    .updateOffset(scrollDirection)\r\n    .drawGrid()\r\n    .drawArena()\r\n    .drawSpells(game.spellList)\r\n    .drawPlayers(game.playerList)\r\n    .drawDebug();\r\n    \r\n  game.update();\r\n}\r\n\r\nfunction startGame () {\r\n  new DomElement('.js-start-menu').htmlElement.style.display = 'none';\r\n  \r\n  game.startGame(playerNameElement.htmlElement.value, () => {\r\n    window.document.addEventListener('keydown', wHandleKeyDown);\r\n    \r\n    canvas.on('contextmenu', event => event.preventDefault());\r\n    canvas.on('mousemove', cHandleMouseMove);\r\n    canvas.on('mousedown', cHandleMouseDown);\r\n  });\r\n  \r\n  game.on('addPlayer', () => graph.player = game.currentPlayer);\r\n  \r\n  if (!animationLoopHandle) {\r\n    lastUpdate = Date.now();\r\n    animationLoop(lastUpdate);\r\n  }\r\n  \r\n  function cHandleMouseMove(event) {\r\n    var westBreakpoint = graph.screenWidth / 10,\r\n        eastBreakpoint = graph.screenWidth * 9 / 10,\r\n        northBreakpoint = graph.screenHeight / 10,\r\n        southBreakpoint = graph.screenHeight * 9 / 10;\r\n        \r\n    if (event.x < westBreakpoint && event.y < northBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_NWEST;\r\n    } else if (event.x > eastBreakpoint && event.y < northBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_NEAST;\r\n    } else if (event.x < westBreakpoint && event.y > southBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_SWEST;\r\n    } else if (event.x > eastBreakpoint && event.y > southBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_SEAST;\r\n    } else if (event.x < westBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_WEST;\r\n    } else if (event.x > eastBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_EAST;\r\n    } else if (event.y < northBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_NORTH;\r\n    } else if (event.y > southBreakpoint) {\r\n      scrollDirection = OPCode.DIRECTION_SOUTH;\r\n    } else {\r\n      scrollDirection = null;\r\n    }\r\n    mouse.x = event.x;\r\n    mouse.y = event.y;\r\n  }\r\n  \r\n  function cHandleMouseDown(event) {\r\n    if (game.currentPlayer && event.button === KeyCode.MOUSE2) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      var now = performance.now();\r\n      var diff = now - targetTick;\r\n      if (diff > 100) {\r\n        var targetX = mouse.x + graph.xOffset;\r\n        var targetY = mouse.y + graph.yOffset;\r\n        targetX = Math.min(Math.max(targetX, 0), graph._gameWidth);\r\n        targetY = Math.min(Math.max(targetY, 0), graph._gameHeight);\r\n        game.currentPlayer.setTarget({ x: targetX, y: targetY});\r\n        targetTick = now;\r\n        game.controller.move(game.currentPlayer);\r\n      }\r\n    }\r\n  }\r\n  \r\n  function wHandleKeyDown(event) {\r\n    switch (event.keyCode) {\r\n      case KeyCode.Q:\r\n        game.controller.cast(OPCode.CAST_PRIMARY, {\r\n          playerX: game.currentPlayer.position.x,\r\n          playerY: game.currentPlayer.position.y,\r\n          x: mouse.x + graph.xOffset,\r\n          y: mouse.y + graph.yOffset\r\n        });\r\n        break;\r\n    }\r\n  }\r\n}","export default class Player {\r\n  constructor(playerModel) {\r\n    playerModel = playerModel || {};\r\n    \r\n    this.id = playerModel.id || -1;\r\n    this.ownerId = playerModel.ownerId || -1;\r\n    this.name = playerModel.name;\r\n    this.health = playerModel.health;\r\n    this.maxHealth = playerModel.maxHealth;\r\n    this.speed = 3;\r\n    this.acceleration = 0.1;\r\n    this.rotation = 0;\r\n    this.targetRotation = 0;\r\n    this.radius = 20;\r\n    this.mass = 20;\r\n    this.velocity = { x: 0, y: 0 };\r\n    this.stunned = 0;\r\n    this._baseFriction = 0.2;\r\n    this._baseRotationTicks = 10;\r\n    this._baseCastTicks = 10;\r\n    this._baseRadius = this.radius;\r\n    this.__maxRadius = 25;\r\n    this.__rotationTicks = this._baseRotationTicks;\r\n    this.__castTicks = this._baseCastTicks;\r\n    this.__friction = this._baseFriction;\r\n    this.__animateCast = false;\r\n    \r\n    this.color = {\r\n      r: playerModel.color.r || 0,\r\n      g: playerModel.color.g | 0,\r\n      b: playerModel.color.b || 0\r\n    };\r\n    \r\n    this.position = {\r\n      x: playerModel.position.x || 0,\r\n      y: playerModel.position.y || 0\r\n    };\r\n    \r\n    this.target = {\r\n      x: (playerModel.target ? playerModel.target.x : null) || playerModel.position.x || 0,\r\n      y: (playerModel.target ? playerModel.target.y : null) || playerModel.position.y || 0\r\n    };\r\n  }\r\n  \r\n  calculateNextPosition(deltaT) {\r\n    if (typeof this.target.x !== 'undefined' && typeof this.target.y !== 'undefined') {\r\n      this._calculatePosition(deltaT);\r\n    }\r\n    if (typeof this.targetRotation !== 'undefined') {\r\n      this._calculateRotation(deltaT);\r\n    }\r\n    if (this.__animateCast) {\r\n      this._updateAnimation();\r\n    }\r\n  }\r\n  \r\n  setTarget(target) {\r\n    this.target = {\r\n      x: target.x,\r\n      y: target.y\r\n    };\r\n    \r\n    this.targetRotation = Math.atan2(target.y - this.position.y, target.x - this.position.x);\r\n    var diff = Math.abs(this.targetRotation - this.rotation);\r\n    \r\n    if (diff > Math.PI / 2) {\r\n      this.__friction = this._baseFriction;\r\n    }\r\n  }\r\n  \r\n  onCast(spell) {\r\n    this.__animateCast = true;\r\n    this.targetRotation = Math.atan2(spell.target.y - this.position.y, spell.target.x - this.position.x);\r\n  }\r\n  \r\n  _calculatePosition(deltaT) {\r\n    if (!this._arePositionsApproximatelyEqual(this.position, this.target) || this.stunned) {\r\n      if (this.__friction < 1) {\r\n        this.__friction += this.acceleration;\r\n      }\r\n      \r\n      var speed = this.speed * this.__friction;\r\n      var velX = this.velocity.x;\r\n      var velY = this.velocity.y;\r\n      var velocity = 0, fn;\r\n      \r\n      if (!this.stunned) {\r\n        var vX = this.target.x - this.position.x;\r\n        var vY = this.target.y - this.position.y;\r\n        var distance = this._getHypotenuseLength(vX, vY);\r\n        \r\n        velX = (vX / distance) * speed;\r\n        velY = (vY / distance) * speed;\r\n      }\r\n      \r\n      if (Math.abs(this.velocity.x - velX) > this.acceleration) {\r\n        velocity = this.acceleration * Math.sign(velX);\r\n        fn = Math.sign(velX) !== 1 ? Math.max : Math.min;\r\n        this.velocity.x = fn(this.velocity.x + velocity, Math.sign(velX) * speed); \r\n      } else {\r\n        this.velocity.x = velX;\r\n      }\r\n      \r\n      if (Math.abs(this.velocity.y - velY) > this.acceleration) {\r\n        velocity = this.acceleration * Math.sign(velY);\r\n        fn = Math.sign(velY) !== 1 ? Math.max : Math.min;\r\n        this.velocity.y = fn(this.velocity.y + velocity, Math.sign(velY) * speed); \r\n      } else {\r\n        this.velocity.y = velY;\r\n      }\r\n      \r\n      this.position.x += this.velocity.x;\r\n      this.position.y += this.velocity.y;\r\n      \r\n      if (this.stunned) {\r\n        this.velocity.x *= (1 - this.acceleration);\r\n        this.velocity.y *= (1 - this.acceleration);\r\n        this.target.x = this.position.x;\r\n        this.target.y = this.position.y;\r\n        this.stunned--;\r\n      }\r\n    } else {\r\n      this.__friction = this._baseFriction;\r\n      this.velocity = { x: 0, y: 0 };\r\n    }\r\n  }\r\n  \r\n  _calculateRotation(deltaT) {\r\n    if (Math.abs(this.rotation - this.targetRotation) > 1e-5) {\r\n      if (this.__rotationTicks > 0) {\r\n        if (this.rotation > Math.PI) {\r\n          this.rotation = -Math.PI - (Math.PI - Math.abs(this.rotation));\r\n        } else if (this.rotation < -Math.PI) {\r\n          this.rotation = Math.PI + (Math.PI - Math.abs(this.rotation));\r\n        }\r\n        if (Math.abs(this.targetRotation - this.rotation) > Math.PI) {\r\n          var diffA = Math.PI - Math.abs(this.rotation);\r\n          var diffB = Math.PI - Math.abs(this.targetRotation);\r\n          var diff = diffA + diffB;\r\n          if (this.rotation > 0) {\r\n            this.rotation += diff / this.__rotationTicks;\r\n          } else {\r\n            this.rotation -= diff / this.__rotationTicks;\r\n          }\r\n        } else {\r\n          this.rotation += (this.targetRotation - this.rotation) / this.__rotationTicks;\r\n        }\r\n      } else {\r\n        this.rotation = this.targetRotation;\r\n        this.__rotationTicks = this._baseRotationTicks;\r\n      }\r\n    }\r\n  }\r\n  \r\n  _updateAnimation() {\r\n    if (this.__castTicks > 0) {\r\n      var sign = Math.sign(this.__castTicks - this._baseCastTicks / 2);\r\n      this.radius += sign * (this.__maxRadius - this.radius) / 4;\r\n      this.__castTicks--;\r\n    } else {\r\n      this.radius = this._baseRadius;\r\n      this.__castTicks = this._baseCastTicks;\r\n      this.__animateCast = false;\r\n      this.targetRotation = Math.atan2(this.target.y - this.position.y, this.target.x - this.position.x);\r\n    }\r\n  }\r\n  \r\n  _getHypotenuseLength(x, y) {\r\n    return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\r\n  }\r\n  \r\n  _arePositionsApproximatelyEqual(positionA, positionB) {\r\n    var errorMargin = 5;\r\n    return (Math.abs(positionA.x - positionB.x) < errorMargin) && (Math.abs(positionA.y - positionB.y) < errorMargin);\r\n  }\r\n}","export { default as Player } from './Player';","export default {\r\n  mapping: {\r\n    id: { type: 'string', length: 32 },\r\n    ownerId: { type: 'string', length: 32},\r\n    name: 'string',\r\n    health: 'uint16le',\r\n    maxHealth: 'uint16le',\r\n    x: 'float32le',\r\n    y: 'float32le',\r\n    r: 'uint8',\r\n    g: 'uint8',\r\n    b: 'uint8'\r\n  },\r\n  transform: (player) => {\r\n    return {\r\n      id: player.id,\r\n      ownerId: player.ownerId,\r\n      name: player.name,\r\n      health: player.health,\r\n      maxHealth: player.maxHealth,\r\n      position: { x: player.x, y: player.y },\r\n      color: { r: player.r, g: player.g, b: player.b }\r\n    }\r\n  }\r\n};","export default {\r\n  mapping: {\r\n    updatedPlayers: [{\r\n      id: { type: 'string', length: 32 },\r\n      ownerId: { type: 'string', length: 32},\r\n      name: 'string',\r\n      health: 'unint16le',\r\n      maxHealth: 'uint16le',\r\n      x: 'float32le',\r\n      y: 'float32le',\r\n      targetX: 'float32le',\r\n      targetY: 'float32le',\r\n      r: 'uint8',\r\n      g: 'uint8',\r\n      b: 'uint8'\r\n    }],\r\n    destroyedPlayers: [{\r\n      id: { type: 'string', length: 32 }\r\n    }]\r\n  },\r\n  transform: (object) => {\r\n    var updatedPlayers = object.updatedPlayers.map(player => {\r\n      return {\r\n        id: player.id,\r\n        ownerId: player.ownerId,\r\n        name: player.health,\r\n        maxHealth: player.maxHealth,\r\n        position: { x: player.x, y: player.y },\r\n        target: { x: player.targetX, y: player.targetY },\r\n        color: { r: player.r, g: player.g, b: player.b }\r\n      }\r\n    });\r\n    var destroyedPlayers = object.destroyedPlayers.map(player => player.id);\r\n    \r\n    return {\r\n      updatedPlayers,\r\n      destroyedPlayers\r\n    };\r\n  }\r\n};","export default {\r\n  mapping: {\r\n    updatedSpells: [{\r\n      id: { type: 'string', length: 32 },\r\n      ownerId: { type: 'string', length: 32 },\r\n      type: 'uint8',\r\n      mass: 'uint8',\r\n      power: 'uint8',\r\n      x: 'float32le',\r\n      y: 'float32le',\r\n      targetX: 'float32le',\r\n      targetY: 'float32le',\r\n      r: 'uint8',\r\n      g: 'uint8',\r\n      b: 'uint8'\r\n    }],\r\n    destroyedSpells: [{\r\n      id: { type: 'string', length: 32 }\r\n    }]\r\n  },\r\n  transform: (object) => {\r\n    var updatedSpells = object.updatedSpells.map(spell => {\r\n      return {\r\n        id: spell.id,\r\n        ownerId: spell.ownerId,\r\n        type: spell.type,\r\n        mass: spell.mass,\r\n        power: spell.power,\r\n        position: { x: spell.x, y: spell.y },\r\n        target: { x: spell.targetX, y: spell.targetY },\r\n        color: { r: spell.r, g: spell.g, b: spell.b }\r\n      }\r\n    });\r\n    var destroyedSpells = object.destroyedSpells.map(spell => spell.id);\r\n    \r\n    return {\r\n      updatedSpells,\r\n      destroyedSpells\r\n    };\r\n  }\r\n}","export { default as AddPlayer } from './AddPlayer';\r\nexport { default as UpdatePlayers } from './UpdatePlayers';\r\nexport { default as UpdateSpells } from './UpdateSpells';","export default class Primary {\r\n  constructor(spellModel) {\r\n    this.id = spellModel.id;\r\n    this.ownerId = spellModel.ownerId;\r\n    this.type = spellModel.type;\r\n    this.mass = spellModel.mass;\r\n    this.power = spellModel.power;\r\n    this.velocity = { x: 0, y: 0 };\r\n    this.speed = 5;\r\n    this.radius = 10;\r\n    \r\n    this.color = spellModel.color || { r: 0, g: 0, b: 0 };\r\n    this.position = spellModel.position || { x: 0, y: 0 };\r\n    \r\n    this.setTarget(spellModel.target);\r\n  }\r\n  \r\n  calculateNextPosition() {\r\n    if (typeof this.velocity.x !== 'undefined' && typeof this.velocity.y !== 'undefined') {\r\n      this._calculatePosition.call(this);\r\n    }\r\n  }\r\n  \r\n  onAdd(owner) {\r\n    owner.onCast(this);\r\n  }\r\n  \r\n  onCollision(model) {\r\n    model.health -= this.power;\r\n    \r\n    model.velocity.x += this.power * this.mass * this.velocity.x / model.mass;\r\n    model.velocity.y += this.power * this.mass * this.velocity.y / model.mass;\r\n    \r\n    model.stunned = 50;\r\n  }\r\n  \r\n  setTarget(target) {\r\n    this.target = {\r\n      x: target.x,\r\n      y: target.y\r\n    };\r\n    \r\n    var vX = this.target.x - this.position.x;\r\n    var vY = this.target.y - this.position.y;\r\n    var distance = this._getHypotenuseLength(vX, vY);\r\n    \r\n    this.velocity = {\r\n      x: vX / distance,\r\n      y: vY / distance\r\n    };\r\n  }\r\n  \r\n  _calculatePosition() {\r\n    this.position = {\r\n      x: this.position.x + this.velocity.x * this.speed,\r\n      y: this.position.y + this.velocity.y * this.speed\r\n    };\r\n  }\r\n  \r\n  _getHypotenuseLength(x, y) {\r\n    return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\r\n  }\r\n}","var OPCode = require('../../../opCode');\r\n\r\nexport { default as Primary } from './Primary';\r\n\r\nexport function get(code) {\r\n  var spell = null;\r\n  \r\n  switch (code) {\r\n    case OPCode.SPELL_PRIMARY:\r\n      spell = module.exports.Primary;\r\n      break;\r\n  }\r\n  \r\n  return spell;\r\n}","export default class DomElement {\r\n  constructor(query, elementClass) {\r\n    this.htmlElement = null;\r\n    this.instance = null;\r\n    this._eventHandlers = [];\r\n    \r\n    if (query) {\r\n      this.htmlElement = window.document.querySelector(query);\r\n      \r\n      if (this.htmlElement && elementClass) {\r\n        this.instance = new elementClass(this.htmlElement);\r\n      }\r\n    }\r\n  }\r\n  \r\n  on(name, listener) {\r\n    if (!(name in this._eventHandlers) || !(this._eventHandlers[name] instanceof Array)) {\r\n      this._eventHandlers[name] = [];\r\n    }\r\n    if (!~this._eventHandlers[name].indexOf(listener)) {\r\n      this._eventHandlers[name].push(listener);\r\n      \r\n      this.htmlElement.addEventListener(name, listener);\r\n    }\r\n    \r\n    return this;\r\n  }\r\n}","export default class EventEmitter {\r\n  constructor() {\r\n    this._eventHandlers = [];\r\n  }\r\n  \r\n  on(name, listener) {\r\n    if (!(name in this._eventHandlers) || !(this._eventHandlers[name] instanceof Array)) {\r\n      this._eventHandlers[name] = [];\r\n    }\r\n    this._eventHandlers[name].push(listener);\r\n  }\r\n  \r\n  _fire(name, options) {\r\n    if (name in this._eventHandlers && this._eventHandlers[name].length > 0) {\r\n      this._eventHandlers[name].forEach(handler => handler(options));\r\n    }\r\n  }\r\n}","export default {\r\n  MOUSE2: 2,\r\n  MAC_ENTER: 3,\r\n  BACKSPACE: 8,\r\n  TAB: 9,\r\n  NUM_CENTER: 12,\r\n  ENTER: 13,\r\n  SHIFT: 16,\r\n  CTRL: 17,\r\n  ALT: 18,\r\n  PAUSE: 19,\r\n  CAPS_LOCK: 20,\r\n  ESC: 27,\r\n  SPACE: 32,\r\n  PAGE_UP: 33,\r\n  PAGE_DOWN: 34,\r\n  END: 35,\r\n  HOME: 36,\r\n  LEFT: 37,\r\n  UP: 38,\r\n  RIGHT: 39,\r\n  DOWN: 40,\r\n  PRINT_SCREEN: 44,\r\n  INSERT: 45,\r\n  DELETE: 46,\r\n  ZERO: 48,\r\n  ONE: 49,\r\n  TWO: 50,\r\n  THREE: 51,\r\n  FOUR: 52,\r\n  FIVE: 53,\r\n  SIX: 54,\r\n  SEVEN: 55,\r\n  EIGHT: 56,\r\n  NINE: 57,\r\n  A: 65,\r\n  B: 66,\r\n  C: 67,\r\n  D: 68,\r\n  E: 69,\r\n  F: 70,\r\n  G: 71,\r\n  H: 72,\r\n  I: 73,\r\n  J: 74,\r\n  K: 75,\r\n  L: 76,\r\n  M: 77,\r\n  N: 78,\r\n  O: 79,\r\n  P: 80,\r\n  Q: 81,\r\n  R: 82,\r\n  S: 83,\r\n  T: 84,\r\n  U: 85,\r\n  V: 86,\r\n  W: 87,\r\n  X: 88,\r\n  Y: 89,\r\n  Z: 90,\r\n  META: 91,\r\n  CONTEXT_MENU: 93,\r\n  NUM_ZERO: 96,\r\n  NUM_ONE: 97,\r\n  NUM_TWO: 98,\r\n  NUM_THREE: 99,\r\n  NUM_FOUR: 100,\r\n  NUM_FIVE: 101,\r\n  NUM_SIX: 102,\r\n  NUM_SEVEN: 103,\r\n  NUM_EIGHT: 104,\r\n  NUM_NINE: 105,\r\n  NUM_MULTIPLY: 106,\r\n  NUM_PLUS: 107,\r\n  NUM_MINUS: 109,\r\n  NUM_PERIOD: 110,\r\n  NUM_DIVISION: 111,\r\n  F1: 112,\r\n  F2: 113,\r\n  F3: 114,\r\n  F4: 115,\r\n  F5: 116,\r\n  F6: 117,\r\n  F7: 118,\r\n  F8: 119,\r\n  F9: 120,\r\n  F10: 121,\r\n  F11: 122,\r\n  F12: 123\r\n};","if (!Array.prototype.find) {\r\n  Array.prototype.find = function (predicate) {\r\n    if (this === null) {\r\n      throw new TypeError('Array.prototype.find called on null or undefined');\r\n    }\r\n    if (typeof predicate !== 'function') {\r\n      throw new TypeError('predicate must be a function');\r\n    }\r\n    var list = Object(this);\r\n    var length = list.length >>> 0;\r\n    var thisArg = arguments[1];\r\n    var value;\r\n\r\n    for (var i = 0; i < length; i++) {\r\n      value = list[i];\r\n      if (predicate.call(thisArg, value, i, list)) {\r\n        return value;\r\n      }\r\n    }\r\n    return undefined;\r\n  };\r\n}\r\n\r\nif (!Date.now) {\r\n  Date.now = function () {\r\n    return new Date().getTime();\r\n  };\r\n}\r\n\r\n(function () {\r\n  'use strict';\r\n\r\n  var vendors = ['webkit', 'moz'];\r\n  for (var i = 0; i < vendors.length && !window.requestAnimationFrame; ++i) {\r\n    var vp = vendors[i];\r\n    window.requestAnimationFrame = window[vp + 'RequestAnimationFrame'];\r\n    window.cancelAnimationFrame = (window[vp + 'CancelAnimationFrame']\r\n      || window[vp + 'CancelRequestAnimationFrame']);\r\n  }\r\n  if (/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent) // iOS6 is buggy\r\n    || !window.requestAnimationFrame || !window.cancelAnimationFrame) {\r\n    var lastTime = 0;\r\n    window.requestAnimationFrame = function (callback) {\r\n      var now = Date.now();\r\n      var nextTime = Math.max(lastTime + 16, now);\r\n      return setTimeout(function () { callback(lastTime = nextTime); },\r\n        nextTime - now);\r\n    };\r\n    window.cancelAnimationFrame = clearTimeout;\r\n  }\r\n} ());","module.exports = {\r\n  // actions\r\n  \"PING\": 0x01,\r\n  \"PONG\": 0x02,\r\n  \"SPAWN_PLAYER\": 0x03,\r\n  \"ADD_PLAYER\": 0x04,\r\n  \"UPDATE_PLAYERS\": 0x05,\r\n  \"UPDATE_SPELLS\": 0x06,\r\n  \"PLAYER_MOVE\": 0x07,\r\n  \r\n  // cast\r\n  \"CAST_PRIMARY\": 0x08,\r\n  \r\n  // types\r\n  \"SPELL_PRIMARY\": 0x0A,\r\n  \r\n  // direction\r\n  \"DIRECTION_WEST\": 0X14,\r\n  \"DIRECTION_EAST\": 0X15,\r\n  \"DIRECTION_NORTH\": 0X16,\r\n  \"DIRECTION_SOUTH\": 0X17,\r\n  \"DIRECTION_NWEST\": 0X18,\r\n  \"DIRECTION_NEAST\": 0X19,\r\n  \"DIRECTION_SWEST\": 0X1A,\r\n  \"DIRECTION_SEAST\": 0X1B\r\n};"]}